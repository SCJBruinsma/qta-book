<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11.3 Structural Topic Model | Introduction to Quantitative Text Analysis</title>
  <meta name="description" content="11.3 Structural Topic Model | Introduction to Quantitative Text Analysis" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="11.3 Structural Topic Model | Introduction to Quantitative Text Analysis" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11.3 Structural Topic Model | Introduction to Quantitative Text Analysis" />
  
  
  

<meta name="author" content="Kostas Gemenis and Bastiaan Bruinsma" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="seeded-latent-dirichlet-allocation.html"/>
<link rel="next" href="texttricks.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="assets/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="assets/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="assets/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="assets/datatables-binding-0.33/datatables.js"></script>
<link href="assets/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="assets/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="assets/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="assets/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="assets/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 2em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="1" data-path="getting-started-with-qta.html"><a href="getting-started-with-qta.html"><i class="fa fa-check"></i><b>1</b> Getting Started with Quantitative Text Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="qta-in-steps.html"><a href="qta-in-steps.html"><i class="fa fa-check"></i><b>1.1</b> QTA in steps</a></li>
<li class="chapter" data-level="1.2" data-path="how-this-book-works.html"><a href="how-this-book-works.html"><i class="fa fa-check"></i><b>1.2</b> How this book works</a></li>
<li class="chapter" data-level="1.3" data-path="further-literature.html"><a href="further-literature.html"><i class="fa fa-check"></i><b>1.3</b> Further Literature</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>2</b> Getting Started with R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="r-on-windows.html"><a href="r-on-windows.html"><i class="fa fa-check"></i><b>2.2</b> R on Windows</a></li>
<li class="chapter" data-level="2.3" data-path="r-on-linux.html"><a href="r-on-linux.html"><i class="fa fa-check"></i><b>2.3</b> R on Linux</a></li>
<li class="chapter" data-level="2.4" data-path="r-on-macos.html"><a href="r-on-macos.html"><i class="fa fa-check"></i><b>2.4</b> R on MacOS</a></li>
<li class="chapter" data-level="2.5" data-path="r-in-the-cloud.html"><a href="r-in-the-cloud.html"><i class="fa fa-check"></i><b>2.5</b> R in the Cloud</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="installing-packages.html"><a href="installing-packages.html"><i class="fa fa-check"></i><b>3</b> Installing Packages</a>
<ul>
<li class="chapter" data-level="3.1" data-path="installing-from-cran.html"><a href="installing-from-cran.html"><i class="fa fa-check"></i><b>3.1</b> Installing from CRAN</a></li>
<li class="chapter" data-level="3.2" data-path="installing-from-github.html"><a href="installing-from-github.html"><i class="fa fa-check"></i><b>3.2</b> Installing from GitHub</a></li>
<li class="chapter" data-level="3.3" data-path="packages-for-quantitative-text-analysis-in-r.html"><a href="packages-for-quantitative-text-analysis-in-r.html"><i class="fa fa-check"></i><b>3.3</b> Packages for Quantitative Text Analysis in R</a></li>
<li class="chapter" data-level="3.4" data-path="problems-bugs-and-errors.html"><a href="problems-bugs-and-errors.html"><i class="fa fa-check"></i><b>3.4</b> Problems, Bugs and Errors</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>4</b> Importing Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="text-in-r.html"><a href="text-in-r.html"><i class="fa fa-check"></i><b>4.1</b> Text in R</a></li>
<li class="chapter" data-level="4.2" data-path="import-.txt-files.html"><a href="import-.txt-files.html"><i class="fa fa-check"></i><b>4.2</b> Import .txt Files</a></li>
<li class="chapter" data-level="4.3" data-path="import-.pdf-files.html"><a href="import-.pdf-files.html"><i class="fa fa-check"></i><b>4.3</b> Import .pdf Files</a></li>
<li class="chapter" data-level="4.4" data-path="import-.csv-files.html"><a href="import-.csv-files.html"><i class="fa fa-check"></i><b>4.4</b> Import .csv Files</a></li>
<li class="chapter" data-level="4.5" data-path="import-from-an-api.html"><a href="import-from-an-api.html"><i class="fa fa-check"></i><b>4.5</b> Import from an API</a></li>
<li class="chapter" data-level="4.6" data-path="import-using-web-scraping.html"><a href="import-using-web-scraping.html"><i class="fa fa-check"></i><b>4.6</b> Import using Web Scraping</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="reliability-validity.html"><a href="reliability-validity.html"><i class="fa fa-check"></i><b>5</b> Reliability and Validity</a>
<ul>
<li class="chapter" data-level="5.1" data-path="inter-coder-agreement.html"><a href="inter-coder-agreement.html"><i class="fa fa-check"></i><b>5.1</b> Inter-Coder Agreement</a></li>
<li class="chapter" data-level="5.2" data-path="visualizing-quality.html"><a href="visualizing-quality.html"><i class="fa fa-check"></i><b>5.2</b> Visualizing Quality</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i><b>6</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-corpus.html"><a href="the-corpus.html"><i class="fa fa-check"></i><b>6.1</b> The Corpus</a></li>
<li class="chapter" data-level="6.2" data-path="keywords-in-context.html"><a href="keywords-in-context.html"><i class="fa fa-check"></i><b>6.2</b> Keywords in Context</a></li>
<li class="chapter" data-level="6.3" data-path="visualisations-and-descriptives.html"><a href="visualisations-and-descriptives.html"><i class="fa fa-check"></i><b>6.3</b> Visualisations and Descriptives</a></li>
<li class="chapter" data-level="6.4" data-path="text-statistics.html"><a href="text-statistics.html"><i class="fa fa-check"></i><b>6.4</b> Text Statistics</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dictionary-analysis.html"><a href="dictionary-analysis.html"><i class="fa fa-check"></i><b>7</b> Dictionary Analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="classical-dictionary-analysis.html"><a href="classical-dictionary-analysis.html"><i class="fa fa-check"></i><b>7.1</b> Classical Dictionary Analysis</a></li>
<li class="chapter" data-level="7.2" data-path="sentiment-analysis.html"><a href="sentiment-analysis.html"><i class="fa fa-check"></i><b>7.2</b> Sentiment Analysis</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sentiment-analysis.html"><a href="sentiment-analysis.html#movie-reviews"><i class="fa fa-check"></i><b>7.2.1</b> Movie Reviews</a></li>
<li class="chapter" data-level="7.2.2" data-path="sentiment-analysis.html"><a href="sentiment-analysis.html#twitter"><i class="fa fa-check"></i><b>7.2.2</b> Twitter</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sentiment-analysis-using-vader.html"><a href="sentiment-analysis-using-vader.html"><i class="fa fa-check"></i><b>7.3</b> Sentiment Analysis using VADER</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exercices.html"><a href="exercices.html"><i class="fa fa-check"></i><b>8</b> Exercices</a></li>
<li class="chapter" data-level="9" data-path="scaling.html"><a href="scaling.html"><i class="fa fa-check"></i><b>9</b> Scaling Methods</a>
<ul>
<li class="chapter" data-level="9.1" data-path="wordscores.html"><a href="wordscores.html"><i class="fa fa-check"></i><b>9.1</b> Wordscores</a></li>
<li class="chapter" data-level="9.2" data-path="wordfish.html"><a href="wordfish.html"><i class="fa fa-check"></i><b>9.2</b> Wordfish</a></li>
<li class="chapter" data-level="9.3" data-path="correspondence-analysis.html"><a href="correspondence-analysis.html"><i class="fa fa-check"></i><b>9.3</b> Correspondence Analysis</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="supervised-methods.html"><a href="supervised-methods.html"><i class="fa fa-check"></i><b>10</b> Supervised Methods</a>
<ul>
<li class="chapter" data-level="10.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html"><i class="fa fa-check"></i><b>10.1</b> Support Vector Machines</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#svm-with-rtexttools"><i class="fa fa-check"></i><b>10.1.1</b> SVM with RTextTools</a></li>
<li class="chapter" data-level="10.1.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#svm-with-quanteda"><i class="fa fa-check"></i><b>10.1.2</b> SVM with Quanteda</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i><b>10.2</b> Naive Bayes</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="unsupervised-methods.html"><a href="unsupervised-methods.html"><i class="fa fa-check"></i><b>11</b> Unsupervised Methods</a>
<ul>
<li class="chapter" data-level="11.1" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html"><i class="fa fa-check"></i><b>11.1</b> Latent Dirichlet Allocation</a></li>
<li class="chapter" data-level="11.2" data-path="seeded-latent-dirichlet-allocation.html"><a href="seeded-latent-dirichlet-allocation.html"><i class="fa fa-check"></i><b>11.2</b> Seeded Latent Dirichlet Allocation</a></li>
<li class="chapter" data-level="11.3" data-path="structural-topic-model.html"><a href="structural-topic-model.html"><i class="fa fa-check"></i><b>11.3</b> Structural Topic Model</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="texttricks.html"><a href="texttricks.html"><i class="fa fa-check"></i><b>12</b> Texttricks</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Quantitative Text Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="structural-topic-model" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Structural Topic Model<a href="structural-topic-model.html#structural-topic-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Besides LDA, various other methods for unsupervised classification exist, such as hierarchical clustering, k-means, and various other mixed membership models. Each of them has its specific advantages and problems, and it often depends on the goal of the researcher to decide which method to use. One new and flexible method is the Structural Topic Model or STM. In R, we can find this method in the <code>stm</code> package <span class="citation">(<a href="#ref-Roberts2019a">Roberts et al., 2019</a>)</span>.</p>
<p>One of the outstanding features of stm is <em>topical prevalence</em>. This means that we can include covariates to help identify the correct model and better understand the topics the model generates <span class="citation">(<a href="#ref-Roberts2014a">Roberts et al., 2014</a>)</span>. For example, we can add information on time to study how topics change over the years; actors on how they differ between different authors; and any other possible variable to see how they differ between them. One of the main advantages of STM is that, unlike in LDA, we are not required to set any parameters in advance. In LDA, these parameters - <span class="math inline">\(\alpha\)</span> (the degree of mixture of topics a document has) and <span class="math inline">\(\beta\)</span> (the degree of mixture of words that a topic has) - have to be set beforehand based on previous knowledge. Yet, this knowledge is not always present and we often need several iterations before we settle upon a correct number. In STM, we use the metadata to set these parameters.</p>
<br />

<div class="figure"><span style="display:block;" id="fig:stm-diagram"></span>
<img src="_main_files/figure-html/stm-diagram-1.png" alt="Plate diagram for a Structucal Topic Model." width="90%" />
<p class="caption">
Figure 11.1: Plate diagram for a Structucal Topic Model.
</p>
</div>
<p><br />
</p>
<p>Figure <a href="structural-topic-model.html#fig:stm-diagram">11.1</a> shows stm in the form of a plate diagram. Here, <span class="math inline">\(X\)</span> refers to the prevalence metadata; <span class="math inline">\(\gamma\)</span>, the metadata weights; <span class="math inline">\(\Sigma\)</span>, the topic covariances; <span class="math inline">\(\theta\)</span>, the document prevalence; <span class="math inline">\(z\)</span>, the per-word topic; <span class="math inline">\(w\)</span>, the observed word; <span class="math inline">\(Y\)</span>, the content metadata; <span class="math inline">\(\beta\)</span>, the topic content; <span class="math inline">\(N\)</span>, the number of words in a document; and <span class="math inline">\(M\)</span>, the number of documents in the corpus.</p>
<p>To run stm in R, we have to load the package, set a seed, convert our dfm to the stm format and place our documents, vocabulary (the tokens) and any other data in three separate objects (for later convenience):</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="structural-topic-model.html#cb232-1" tabindex="-1"></a><span class="fu">library</span>(stm)</span>
<span id="cb232-2"><a href="structural-topic-model.html#cb232-2" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span>
<span id="cb232-3"><a href="structural-topic-model.html#cb232-3" tabindex="-1"></a></span>
<span id="cb232-4"><a href="structural-topic-model.html#cb232-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb232-5"><a href="structural-topic-model.html#cb232-5" tabindex="-1"></a></span>
<span id="cb232-6"><a href="structural-topic-model.html#cb232-6" tabindex="-1"></a>data_inaugural_stm <span class="ot">&lt;-</span> <span class="fu">convert</span>(data_inaugural_dfm, <span class="at">to =</span> <span class="st">&quot;stm&quot;</span>)</span>
<span id="cb232-7"><a href="structural-topic-model.html#cb232-7" tabindex="-1"></a></span>
<span id="cb232-8"><a href="structural-topic-model.html#cb232-8" tabindex="-1"></a>documents <span class="ot">&lt;-</span> data_inaugural_stm<span class="sc">$</span>documents</span>
<span id="cb232-9"><a href="structural-topic-model.html#cb232-9" tabindex="-1"></a>vocabulary <span class="ot">&lt;-</span> data_inaugural_stm<span class="sc">$</span>vocab</span>
<span id="cb232-10"><a href="structural-topic-model.html#cb232-10" tabindex="-1"></a>meta <span class="ot">&lt;-</span> data_inaugural_stm<span class="sc">$</span>meta</span></code></pre></div>
<p>The first thing we have to do is find the number of topics we need. In the <code>stm</code> package, we can do this by using a function called <code>searchK</code>. Here, we specify a range of values that could include the ‘correct’ number of topics, which we then run and collect. Afterwards, we then look at several goodness-of-fit measures to assess which number of topics (which <em>k</em>) has the best fit for the data. These measures include exclusivity, semantic coherence, held-out likelihood, bound, lbound, and residual dispersion. Here, we run this for 2 to 15 possible topics.</p>
<p>In our code, we specify our documents, our tokens (the vocabulary), and our meta-data. Moreover, as our prevalence, we include parameters for <code>Year</code> and <code>Party</code>, as we expect the content of the topics to differ between both the Republican and Democratic party, as well as over time:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="structural-topic-model.html#cb233-1" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>)</span></code></pre></div>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="structural-topic-model.html#cb234-1" tabindex="-1"></a>findingk <span class="ot">&lt;-</span> <span class="fu">searchK</span>(documents, vocabulary, k, <span class="at">prevalence =</span><span class="sc">~</span> Party <span class="sc">+</span> <span class="fu">s</span>(Year), <span class="at">data =</span> meta, <span class="at">verbose=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="structural-topic-model.html#cb235-1" tabindex="-1"></a>findingk_results <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="fu">unlist</span>(findingk<span class="sc">$</span>results), <span class="at">nrow=</span><span class="fu">length</span>(<span class="fu">unlist</span>(findingk<span class="sc">$</span>results[<span class="dv">1</span>]))))</span>
<span id="cb235-2"><a href="structural-topic-model.html#cb235-2" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">names</span>(findingk<span class="sc">$</span>results)</span>
<span id="cb235-3"><a href="structural-topic-model.html#cb235-3" tabindex="-1"></a><span class="fu">names</span>(findingk_results) <span class="ot">&lt;-</span> names</span></code></pre></div>
<p>Looking at <code>findingk_results</code> we find various values. The first, exclusivity, refers to the occurrence that when words have a high probability under one topic, they have a low probability under others. Related to this is semantic coherence which happens when the most probable words in a topic should occur in the same document. Held-out (or held-out log-likelihood) is the likelihood of our model on data that was not used in the initial estimation (the lower the better), while residuals refer to the difference between a data point and the mean value that the model predicts for that data point (which we want to be 1, indicating a standard distribution). Finally, bound and lbound refer to a model’s internal measure of fit. Here, we will be looking for the number of topics, that balance the exclusivity and the semantic coherence, have a residual around 1, and a low held-out. To make this simpler, we visualise our data. In the first graph we plot all the values, while in the second, we only look at the exclusivity and the semantic coherence (as they are the most important):</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="structural-topic-model.html#cb236-1" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb236-2"><a href="structural-topic-model.html#cb236-2" tabindex="-1"></a></span>
<span id="cb236-3"><a href="structural-topic-model.html#cb236-3" tabindex="-1"></a>findingk_melt <span class="ot">&lt;-</span> <span class="fu">melt</span>(findingk_results, <span class="at">id=</span><span class="st">&quot;K&quot;</span>) </span>
<span id="cb236-4"><a href="structural-topic-model.html#cb236-4" tabindex="-1"></a>findingk_melt<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">as.character</span>(findingk_melt<span class="sc">$</span>variable)</span>
<span id="cb236-5"><a href="structural-topic-model.html#cb236-5" tabindex="-1"></a>findingk<span class="sc">$</span>K <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(findingk_results<span class="sc">$</span>K)</span>
<span id="cb236-6"><a href="structural-topic-model.html#cb236-6" tabindex="-1"></a></span>
<span id="cb236-7"><a href="structural-topic-model.html#cb236-7" tabindex="-1"></a><span class="fu">ggplot</span>(findingk_melt, <span class="fu">aes</span>(K, value)) <span class="sc">+</span></span>
<span id="cb236-8"><a href="structural-topic-model.html#cb236-8" tabindex="-1"></a> <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb236-9"><a href="structural-topic-model.html#cb236-9" tabindex="-1"></a> <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb236-10"><a href="structural-topic-model.html#cb236-10" tabindex="-1"></a> <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb236-11"><a href="structural-topic-model.html#cb236-11" tabindex="-1"></a> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/ggplot-stm-findk-1.png" width="672" /></p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="structural-topic-model.html#cb237-1" tabindex="-1"></a><span class="fu">ggplot</span>(findingk_results, <span class="fu">aes</span>(semcoh, exclus)) <span class="sc">+</span></span>
<span id="cb237-2"><a href="structural-topic-model.html#cb237-2" tabindex="-1"></a> <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb237-3"><a href="structural-topic-model.html#cb237-3" tabindex="-1"></a> <span class="fu">geom_text</span>(<span class="at">data=</span>findingk_results, <span class="at">label=</span>findingk<span class="sc">$</span>K, <span class="at">nudge_x =</span> <span class="fl">0.15</span>)<span class="sc">+</span></span>
<span id="cb237-4"><a href="structural-topic-model.html#cb237-4" tabindex="-1"></a> <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Semantic Coherence&quot;</span>)<span class="sc">+</span></span>
<span id="cb237-5"><a href="structural-topic-model.html#cb237-5" tabindex="-1"></a> <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Exclusivity&quot;</span>)<span class="sc">+</span></span>
<span id="cb237-6"><a href="structural-topic-model.html#cb237-6" tabindex="-1"></a> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/ggplot-stm-findk-2.png" width="672" /></p>
<p>Based on these graphs, we decide upon 8 topics. The main reason for this is that for this number of topics, there is a high semantic coherence given the exclusivity. We can now run our stm model, using spectral initialization and a topical prevalence including both the Party and the Year of the inauguration. Also, we have a look at the topics, and the words with the highest probability attached to them:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="structural-topic-model.html#cb238-1" tabindex="-1"></a>n_topics <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb238-2"><a href="structural-topic-model.html#cb238-2" tabindex="-1"></a>output_stm <span class="ot">&lt;-</span> <span class="fu">stm</span>(documents, vocabulary, <span class="at">K =</span> n_topics, <span class="at">prevalence =</span><span class="sc">~</span> Party <span class="sc">+</span> <span class="fu">s</span>(Year), <span class="at">data =</span> meta, <span class="at">init.type =</span> <span class="st">&quot;Spectral&quot;</span>, <span class="at">verbose=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="structural-topic-model.html#cb239-1" tabindex="-1"></a><span class="fu">labelTopics</span>(output_stm)</span></code></pre></div>
<pre><code>## Topic 1 Top Words:
##       Highest Prob: free, peace, world, shall, freedom, must, faith 
##       FREX: strive, free, peoples, everywhere, truth, man&#39;s, learned 
##       Lift: abhorring, absorbing, abstractions, acquire, aggressor, amass, andes 
##       Score: anguished, productivity, strive, trial, learned, europe, defines 
## Topic 2 Top Words:
##       Highest Prob: us, new, world, let, can, people, america 
##       FREX: let, century, together, new, weapons, voices, abroad 
##       Lift: 200th, 20th, dawn, explore, micah, moon, music 
##       Score: attempting, nuclear, let, celebrate, voices, abroad, dawn 
## Topic 3 Top Words:
##       Highest Prob: us, must, world, government, people, america, can 
##       FREX: civilization, republic, experiment, normal, relationship, order, industrial 
##       Lift: deliberate, inspiration, intention, regards, tremendous, unshaken, abnormal 
##       Score: accompanied, supreme, regards, deliberate, inspiration, unshaken, righteousness 
## Topic 4 Top Words:
##       Highest Prob: us, america, nation, can, must, new, people 
##       FREX: story, thank, president, defend, everyone, children, america 
##       Lift: breeze, democracy&#39;s, january, page, angel, begins, blowing 
##       Score: allowing, story, breeze, talk, crucial, everyone, virus 
## Topic 5 Top Words:
##       Highest Prob: freedom, nation, people, america, government, know, democracy 
##       FREX: speaks, mind, democracy, liberty, seen, came, millions 
##       Lift: abreast, absence, admiration, agent, amount, aspires, attempts 
##       Score: charta, speaks, paint, disaster, mind, defended, seen 
## Topic 6 Top Words:
##       Highest Prob: us, must, nation, people, can, new, every 
##       FREX: generation, journey, union, change, covenant, creed, enduring 
##       Lift: demanded, mastery, span, storms, absolutism, abundantly, afghanistan 
##       Score: abundantly, covenant, journey, mastery, storms, demanded, span 
## Topic 7 Top Words:
##       Highest Prob: can, world, people, peace, nations, must, government 
##       FREX: settlement, enforcement, countries, desire, party, international, property 
##       Lift: aided, eighteenth, abilities, abound, abounding, absurd, acceptance 
##       Score: abound, enforcement, contributed, settlement, property, major, eighteenth 
## Topic 8 Top Words:
##       Highest Prob: upon, government, shall, can, must, great, may 
##       FREX: army, interstate, negro, executive, tariff, business, proper 
##       Lift: cuba, incoming, type, affected, amendments, antitrust, army 
##       Score: tariff, interstate, army, negro, policy, proper, business</code></pre>
<p>Here, we see that the word <code>us</code> is dominant in most topics, making it a candidate for removal as a stop word in a future analysis. Looking closer, we find that the first topic refers to peace, the second, third and seventh to the world, the fourth and sixth to America, and the eighth to the government.</p>
<p>Finally, we can see whether there is any relation between these topics and any of the parameters we included. Here, let us look at any existing differences between the two parties:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="structural-topic-model.html#cb241-1" tabindex="-1"></a>est_assoc_effect <span class="ot">&lt;-</span> <span class="fu">estimateEffect</span>(<span class="sc">~</span>Party, output_stm, <span class="at">metadata =</span> meta, <span class="at">prior=</span><span class="fl">1e-5</span>)</span></code></pre></div>
<p>While we can visualise this with the <code>plot.estimateEffect</code> option, the visualisation is far from ideal. Thus, let us use some data-wrangling and make the plot ourselves:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="structural-topic-model.html#cb242-1" tabindex="-1"></a>estimate_data <span class="ot">&lt;-</span> <span class="fu">plot.estimateEffect</span>(est_assoc_effect, <span class="st">&quot;Party&quot;</span>, <span class="at">method =</span> <span class="st">&quot;pointestimate&quot;</span>, <span class="at">model =</span> output_stm, <span class="at">omit.plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb242-2"><a href="structural-topic-model.html#cb242-2" tabindex="-1"></a>estimate_graph_means <span class="ot">&lt;-</span> estimate_data<span class="sc">$</span>means</span>
<span id="cb242-3"><a href="structural-topic-model.html#cb242-3" tabindex="-1"></a>estimate_graph_means <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">unlist</span>(estimate_graph_means), <span class="at">nrow=</span><span class="fu">length</span>(estimate_graph_means), <span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb242-4"><a href="structural-topic-model.html#cb242-4" tabindex="-1"></a>estimate_graph_means <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Republicans&quot;</span>, <span class="dv">8</span>), <span class="fu">rep</span>(<span class="st">&quot;Democrats&quot;</span>, <span class="dv">8</span>)), <span class="fu">c</span>(estimate_graph_means<span class="sc">$</span>X1,estimate_graph_means<span class="sc">$</span>X2))</span>
<span id="cb242-5"><a href="structural-topic-model.html#cb242-5" tabindex="-1"></a></span>
<span id="cb242-6"><a href="structural-topic-model.html#cb242-6" tabindex="-1"></a>estimate_graph_cis <span class="ot">&lt;-</span> estimate_data<span class="sc">$</span>cis</span>
<span id="cb242-7"><a href="structural-topic-model.html#cb242-7" tabindex="-1"></a>estimate_graph_cis <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">unlist</span>(estimate_graph_cis), <span class="at">nrow=</span><span class="fu">length</span>(estimate_graph_cis), <span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb242-8"><a href="structural-topic-model.html#cb242-8" tabindex="-1"></a>estimate_graph_cis <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(estimate_graph_cis<span class="sc">$</span>X1,estimate_graph_cis<span class="sc">$</span>X3), <span class="fu">c</span>(estimate_graph_cis<span class="sc">$</span>X2,estimate_graph_cis<span class="sc">$</span>X4))</span>
<span id="cb242-9"><a href="structural-topic-model.html#cb242-9" tabindex="-1"></a></span>
<span id="cb242-10"><a href="structural-topic-model.html#cb242-10" tabindex="-1"></a>Topic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Topic 1&quot;</span>, <span class="st">&quot;Topic 2&quot;</span>, <span class="st">&quot;Topic 3&quot;</span>, <span class="st">&quot;Topic 4&quot;</span>,<span class="st">&quot;Topic 5&quot;</span>, <span class="st">&quot;Topic 6&quot;</span>, <span class="st">&quot;Topic 7&quot;</span>, <span class="st">&quot;Topic 8&quot;</span>, <span class="st">&quot;Topic 1&quot;</span>, <span class="st">&quot;Topic 2&quot;</span>, <span class="st">&quot;Topic 3&quot;</span>, <span class="st">&quot;Topic 4&quot;</span>,<span class="st">&quot;Topic 5&quot;</span>, <span class="st">&quot;Topic 6&quot;</span>, <span class="st">&quot;Topic 7&quot;</span>, <span class="st">&quot;Topic 8&quot;</span>)</span>
<span id="cb242-11"><a href="structural-topic-model.html#cb242-11" tabindex="-1"></a></span>
<span id="cb242-12"><a href="structural-topic-model.html#cb242-12" tabindex="-1"></a>estimate_graph <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Topic, estimate_graph_means,estimate_graph_cis)</span>
<span id="cb242-13"><a href="structural-topic-model.html#cb242-13" tabindex="-1"></a><span class="fu">names</span>(estimate_graph) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Topic&quot;</span>,<span class="st">&quot;Party&quot;</span>,<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>)</span>
<span id="cb242-14"><a href="structural-topic-model.html#cb242-14" tabindex="-1"></a>estimate_graph<span class="sc">$</span>Party <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(estimate_graph<span class="sc">$</span>Party)</span>
<span id="cb242-15"><a href="structural-topic-model.html#cb242-15" tabindex="-1"></a>estimate_graph<span class="sc">$</span>Topic <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(estimate_graph<span class="sc">$</span>Topic)</span>
<span id="cb242-16"><a href="structural-topic-model.html#cb242-16" tabindex="-1"></a>estimate_graph<span class="sc">$</span>Topic <span class="ot">&lt;-</span> <span class="fu">factor</span>(estimate_graph<span class="sc">$</span>Topic, <span class="at">levels=</span><span class="fu">rev</span>(<span class="fu">levels</span>(estimate_graph<span class="sc">$</span>Topic)))</span></code></pre></div>
<p>Now, let us plot our intervals:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="structural-topic-model.html#cb243-1" tabindex="-1"></a><span class="fu">ggplot</span>(estimate_graph, <span class="fu">aes</span>(Mean, Topic)) <span class="sc">+</span></span>
<span id="cb243-2"><a href="structural-topic-model.html#cb243-2" tabindex="-1"></a> <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> min, <span class="at">xmax =</span> max, <span class="at">color =</span> Party),</span>
<span id="cb243-3"><a href="structural-topic-model.html#cb243-3" tabindex="-1"></a>                 <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>))<span class="sc">+</span></span>
<span id="cb243-4"><a href="structural-topic-model.html#cb243-4" tabindex="-1"></a> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb243-5"><a href="structural-topic-model.html#cb243-5" tabindex="-1"></a>            <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">size=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb243-6"><a href="structural-topic-model.html#cb243-6" tabindex="-1"></a> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#0015BC&quot;</span>, <span class="st">&quot;#E9141D&quot;</span>))<span class="sc">+</span></span>
<span id="cb243-7"><a href="structural-topic-model.html#cb243-7" tabindex="-1"></a> <span class="fu">theme_classic</span>()</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img src="_main_files/figure-html/ggplot-stm-intervals-1.png" width="672" /></p>
<p>Here, we find that while the averages for the topic do seem to differ a little between both of the parties, all the intervals are overlapping, indicating that they are not that different.</p>

</div>
<!-- </div> -->
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="2">
<div id="ref-Roberts2019a" class="csl-entry">
Roberts, M. E., Stewart, B. M., &amp; Tingley, D. (2019). <span class="nocase">stm: An R Package for Structural Topic Models</span>. <em>Journal of Statistical Software</em>, <em>91</em>(2). <a href="https://doi.org/10.18637/jss.v091.i02">https://doi.org/10.18637/jss.v091.i02</a>
</div>
<div id="ref-Roberts2014a" class="csl-entry">
Roberts, M. E., Stewart, B. M., Tingley, D., Lucas, C., Leder-Luis, J., Gadarian, S. K., Albertson, B., &amp; Rand, D. G. (2014). Structural topic models for open-ended survey responses. <em>American Journal of Political Science</em>, <em>58</em>(4), 1064–1082. <a href="https://doi.org/10.1111/ajps.12103">https://doi.org/10.1111/ajps.12103</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="seeded-latent-dirichlet-allocation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="texttricks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
