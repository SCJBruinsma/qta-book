<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Preparing the Data | Quantitative Text Analysis</title>
  <meta name="description" content="Theory and Methods for Quantitative Text Analysis" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Preparing the Data | Quantitative Text Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Theory and Methods for Quantitative Text Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Preparing the Data | Quantitative Text Analysis" />
  
  <meta name="twitter:description" content="Theory and Methods for Quantitative Text Analysis" />
  

<meta name="author" content="Kostas Gemenis &amp; Bastiaan Bruinsma" />


<meta name="date" content="2021-04-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="getting-ready.html"/>
<link rel="next" href="reliability-and-validity.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intro to Quantitative Text Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Foreword</a></li>
<li class="chapter" data-level="2" data-path="getting-ready.html"><a href="getting-ready.html"><i class="fa fa-check"></i><b>2</b> Getting Ready</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-ready.html"><a href="getting-ready.html#installing-r"><i class="fa fa-check"></i><b>2.1</b> Installing R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="getting-ready.html"><a href="getting-ready.html#r-on-windows"><i class="fa fa-check"></i><b>2.1.1</b> R on Windows</a></li>
<li class="chapter" data-level="2.1.2" data-path="getting-ready.html"><a href="getting-ready.html#r-on-linux"><i class="fa fa-check"></i><b>2.1.2</b> R on Linux</a></li>
<li class="chapter" data-level="2.1.3" data-path="getting-ready.html"><a href="getting-ready.html#r-on-macos"><i class="fa fa-check"></i><b>2.1.3</b> R on macOS</a></li>
<li class="chapter" data-level="2.1.4" data-path="getting-ready.html"><a href="getting-ready.html#r-in-the-cloud"><i class="fa fa-check"></i><b>2.1.4</b> R in the Cloud</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="getting-ready.html"><a href="getting-ready.html#packages"><i class="fa fa-check"></i><b>2.2</b> Packages</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-ready.html"><a href="getting-ready.html#installing-from-cran"><i class="fa fa-check"></i><b>2.2.1</b> Installing from CRAN</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-ready.html"><a href="getting-ready.html#installing-from-github"><i class="fa fa-check"></i><b>2.2.2</b> Installing from GitHub</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-ready.html"><a href="getting-ready.html#quanteda"><i class="fa fa-check"></i><b>2.3</b> Quanteda</a></li>
<li class="chapter" data-level="2.4" data-path="getting-ready.html"><a href="getting-ready.html#issues-bugs-and-errors"><i class="fa fa-check"></i><b>2.4</b> Issues, Bugs and Errors</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="preparing-the-data.html"><a href="preparing-the-data.html"><i class="fa fa-check"></i><b>3</b> Preparing the Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="preparing-the-data.html"><a href="preparing-the-data.html#text-in-r"><i class="fa fa-check"></i><b>3.1</b> Text in R</a></li>
<li class="chapter" data-level="3.2" data-path="preparing-the-data.html"><a href="preparing-the-data.html#import-.pdf-files"><i class="fa fa-check"></i><b>3.2</b> Import .pdf Files</a></li>
<li class="chapter" data-level="3.3" data-path="preparing-the-data.html"><a href="preparing-the-data.html#import-.txt-files"><i class="fa fa-check"></i><b>3.3</b> Import .txt Files</a></li>
<li class="chapter" data-level="3.4" data-path="preparing-the-data.html"><a href="preparing-the-data.html#import-.csv-files"><i class="fa fa-check"></i><b>3.4</b> Import .csv Files</a></li>
<li class="chapter" data-level="3.5" data-path="preparing-the-data.html"><a href="preparing-the-data.html#import-using-web-scraping"><i class="fa fa-check"></i><b>3.5</b> Import using Web Scraping</a></li>
<li class="chapter" data-level="3.6" data-path="preparing-the-data.html"><a href="preparing-the-data.html#import-from-an-api"><i class="fa fa-check"></i><b>3.6</b> Import from an API</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reliability-and-validity.html"><a href="reliability-and-validity.html"><i class="fa fa-check"></i><b>4</b> Reliability and validity</a>
<ul>
<li class="chapter" data-level="4.1" data-path="reliability-and-validity.html"><a href="reliability-and-validity.html#measuring-inter-coder-agreement"><i class="fa fa-check"></i><b>4.1</b> Measuring inter-coder agreement</a></li>
<li class="chapter" data-level="4.2" data-path="reliability-and-validity.html"><a href="reliability-and-validity.html#visualizing-the-quality-of-coding"><i class="fa fa-check"></i><b>4.2</b> Visualizing the quality of coding</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dictionaries.html"><a href="dictionaries.html"><i class="fa fa-check"></i><b>5</b> Dictionaries</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dictionaries.html"><a href="dictionaries.html#working-with-a-corpus"><i class="fa fa-check"></i><b>5.1</b> Working with a Corpus</a></li>
<li class="chapter" data-level="5.2" data-path="dictionaries.html"><a href="dictionaries.html#standard-dictionary-analysis"><i class="fa fa-check"></i><b>5.2</b> Standard Dictionary Analysis</a></li>
<li class="chapter" data-level="5.3" data-path="dictionaries.html"><a href="dictionaries.html#sentiment-analysis"><i class="fa fa-check"></i><b>5.3</b> Sentiment Analysis</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="scaling.html"><a href="scaling.html"><i class="fa fa-check"></i><b>6</b> Scaling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="scaling.html"><a href="scaling.html#wordscores"><i class="fa fa-check"></i><b>6.1</b> Wordscores</a></li>
<li class="chapter" data-level="6.2" data-path="scaling.html"><a href="scaling.html#wordfish"><i class="fa fa-check"></i><b>6.2</b> Wordfish</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="supervised-methods.html"><a href="supervised-methods.html"><i class="fa fa-check"></i><b>7</b> Supervised Methods</a>
<ul>
<li class="chapter" data-level="7.1" data-path="supervised-methods.html"><a href="supervised-methods.html#support-vector-machines"><i class="fa fa-check"></i><b>7.1</b> Support Vector Machines</a></li>
<li class="chapter" data-level="7.2" data-path="supervised-methods.html"><a href="supervised-methods.html#naive-bayes"><i class="fa fa-check"></i><b>7.2</b> Naive Bayes</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="unsupervised-methods.html"><a href="unsupervised-methods.html"><i class="fa fa-check"></i><b>8</b> Unsupervised Methods</a>
<ul>
<li class="chapter" data-level="8.1" data-path="unsupervised-methods.html"><a href="unsupervised-methods.html#latent-dirichlet-allocation"><i class="fa fa-check"></i><b>8.1</b> Latent Dirichlet Allocation</a></li>
<li class="chapter" data-level="8.2" data-path="unsupervised-methods.html"><a href="unsupervised-methods.html#correspondence-analysis"><i class="fa fa-check"></i><b>8.2</b> Correspondence Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="bruinsma@soz.uni-frankfurt.de" target="blank">Bastiaan Bruinsma</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Text Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="preparing-the-data" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Preparing the Data</h1>
<p>No analysis is possible unless we have some data to work with. In the following exercises, we will look at five different ways to get textual data into R: a) by using .pdf files, b) by using .txt files, c) by using .csv files, d) by using web scraping, and e) by using an API. Before we get to these methods, we will look at how R handles text and how we can work with it.</p>
<div id="text-in-r" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Text in R</h2>
<p>R sees any form of text as a type of characters vector. In their simplest form, these vectors only have a single character in it. At their most complicated, they can contain many sentences or even whole stories. To see how many characters a vector has, we can use the <code>nchar</code> function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="preparing-the-data.html#cb5-1" aria-hidden="true" tabindex="-1"></a>vector1 <span class="ot">&lt;-</span> <span class="st">&quot;This is the first of our character vectors&quot;</span></span>
<span id="cb5-2"><a href="preparing-the-data.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nchar</span>(vector1)</span></code></pre></div>
<pre><code>## [1] 42</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="preparing-the-data.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(vector1)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>This example also shows the logic of R. First, we assign the text we have to a certain object. We do so using the <code>&lt;-</code> arrow. This arrow points from the text we have to the object R stores it in, which we here call <code>vector1</code>. We then ask R to give us the number of characters inside this object, 40 in this case. The <code>length</code> command returns something else, namely 1. This means that we have a single sentence, or word, in our object. If we want to, we can place more sentences inside our object using the <code>c()</code> option:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="preparing-the-data.html#cb9-1" aria-hidden="true" tabindex="-1"></a>vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;This is an example&quot;</span>, <span class="st">&quot;This is another&quot;</span>, <span class="st">&quot;And so we can go on.&quot;</span>)</span>
<span id="cb9-2"><a href="preparing-the-data.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(vector2)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="preparing-the-data.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nchar</span>(vector2)</span></code></pre></div>
<pre><code>## [1] 18 15 20</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="preparing-the-data.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">nchar</span>(vector2))</span></code></pre></div>
<pre><code>## [1] 53</code></pre>
<p>Another thing we can do is extract certain words from a sentence. For this, we use the <code>substr()</code> function. With this function, R gives us all the characters that occur between two specific positions. So, when we want the characters between the 4th and 10th characters, we write:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="preparing-the-data.html#cb15-1" aria-hidden="true" tabindex="-1"></a>vector3 <span class="ot">&lt;-</span> <span class="st">&quot;This is yet another sentence&quot;</span></span>
<span id="cb15-2"><a href="preparing-the-data.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(vector3, <span class="dv">4</span>, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] &quot;s is ye&quot;</code></pre>
<p>We can also split a character vector into smaller parts. We often do this when we want to split a longer text into several sentences. To do so, we use the <code>strsplit</code> function:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="preparing-the-data.html#cb17-1" aria-hidden="true" tabindex="-1"></a>vector3 <span class="ot">&lt;-</span> <span class="st">&quot;Here is a sentence - And a second&quot;</span></span>
<span id="cb17-2"><a href="preparing-the-data.html#cb17-2" aria-hidden="true" tabindex="-1"></a>parts1 <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(vector3, <span class="st">&quot;-&quot;</span>)</span>
<span id="cb17-3"><a href="preparing-the-data.html#cb17-3" aria-hidden="true" tabindex="-1"></a>parts1</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;Here is a sentence &quot; &quot; And a second&quot;</code></pre>
<p>If we now look in the Environment window, we will see that R calls <code>parts1</code> a list. This is another type of object that R uses to store information. We will see it more often later on. For now, it is good to remember that lists in R can have many vectors (the layers of the list) and that in each of these vectors we can store many objects. Here, our list has only a single vector. To create a longer list, we have to add more vectors, and then join them together, again using the <code>c()</code> command:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="preparing-the-data.html#cb19-1" aria-hidden="true" tabindex="-1"></a>vector4 <span class="ot">&lt;-</span> <span class="st">&quot;Here is another sentence - And one more&quot;</span></span>
<span id="cb19-2"><a href="preparing-the-data.html#cb19-2" aria-hidden="true" tabindex="-1"></a>parts2 <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(vector4, <span class="st">&quot;-&quot;</span>)</span>
<span id="cb19-3"><a href="preparing-the-data.html#cb19-3" aria-hidden="true" tabindex="-1"></a>parts3 <span class="ot">&lt;-</span> <span class="fu">c</span>(parts1, parts2)</span></code></pre></div>
<p>We can now look at this new list in the Environment and check that it indeed has two elements. A further thing we can do is to join many vectors together. For this, we can use the <code>paste</code> function. Here, the <code>sep</code> argument defines how R will combine the elements:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="preparing-the-data.html#cb20-1" aria-hidden="true" tabindex="-1"></a>fruits <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;oranges&quot;</span>, <span class="st">&quot;lemons&quot;</span>, <span class="st">&quot;pears&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>)</span>
<span id="cb20-2"><a href="preparing-the-data.html#cb20-2" aria-hidden="true" tabindex="-1"></a>fruits</span></code></pre></div>
<pre><code>## [1] &quot;oranges-lemons-pears&quot;</code></pre>
<p>Note that we can also use this command that paste objects that we made earlier together. For example:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="preparing-the-data.html#cb22-1" aria-hidden="true" tabindex="-1"></a>sentences <span class="ot">&lt;-</span> <span class="fu">paste</span>(vector3, vector4, <span class="at">sep =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb22-2"><a href="preparing-the-data.html#cb22-2" aria-hidden="true" tabindex="-1"></a>sentences</span></code></pre></div>
<pre><code>## [1] &quot;Here is a sentence - And a second.Here is another sentence - And one more&quot;</code></pre>
<p>Finally, we can change the case of the sentence. To do this, we can use <code>tolower</code> and <code>toupper</code>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="preparing-the-data.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tolower</span>(sentences)</span></code></pre></div>
<pre><code>## [1] &quot;here is a sentence - and a second.here is another sentence - and one more&quot;</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="preparing-the-data.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">toupper</span>(sentences)</span></code></pre></div>
<pre><code>## [1] &quot;HERE IS A SENTENCE - AND A SECOND.HERE IS ANOTHER SENTENCE - AND ONE MORE&quot;</code></pre>
<p>Again, we can also run the same command when we have more than a single element in our vector:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="preparing-the-data.html#cb28-1" aria-hidden="true" tabindex="-1"></a>sentences2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;This is a piece of example text&quot;</span>, <span class="st">&quot;This is another piece of example text&quot;</span>)</span>
<span id="cb28-2"><a href="preparing-the-data.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">toupper</span>(sentences2)</span></code></pre></div>
<pre><code>## [1] &quot;THIS IS A PIECE OF EXAMPLE TEXT&quot;      
## [2] &quot;THIS IS ANOTHER PIECE OF EXAMPLE TEXT&quot;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="preparing-the-data.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tolower</span>(sentences2)</span></code></pre></div>
<pre><code>## [1] &quot;this is a piece of example text&quot;      
## [2] &quot;this is another piece of example text&quot;</code></pre>
<p>And that is it. As you can see, the options for text analysis in basic R are rather limited. This is why packages such as <code>quanteda</code> exist in the first place. Note though, that even <code>quanteda</code> uses the same logic of character vectors and combinations that we saw here.</p>
</div>
<div id="import-.pdf-files" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Import .pdf Files</h2>
<p>One of the most popular formats for digital texts is the portable document format (.pdf). To read .pdf files into R, we need two packages. The <code>pdftools</code> package to convert the .pdf files into .txt files, and the <code>readtext</code> package to read the .txt files into R. Note that this only works if the .pdf files are <em>readable</em>. This means that we can select (and copy-paste) the text in them. Thus, <code>readtext</code> does not work with .pdf files that the text in them cannot be selected (this is most likely because the pages of the document were scanned as images before turned into a .pdf file). If we have a .pdf file of this type, one solution is to use the <code>tesseract</code> package, which can use optical character recognition technology (OCR) to fix this issue.</p>
<p>To import the .pdf files, we start by loading the required libraries into R:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="preparing-the-data.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pdftools)</span>
<span id="cb32-2"><a href="preparing-the-data.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readtext)</span></code></pre></div>
<p>Then, we go to our working directory (to see where this is, type <code>getwd()</code> into the Console). Here, we make two folders: one in which to store the .pdf files - called <em>PDF</em> - and another new and empty folder in which to store the .txt files. We call this one <em>Texts</em>. Ensure that all the .pdf files are in the <em>PDF</em> folder. Then, we tell R about these folders:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="preparing-the-data.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;Your Working Directory&quot;</span>)</span>
<span id="cb33-2"><a href="preparing-the-data.html#cb33-2" aria-hidden="true" tabindex="-1"></a>pdf_directory <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(), <span class="st">&quot;/PDF&quot;</span>)</span>
<span id="cb33-3"><a href="preparing-the-data.html#cb33-3" aria-hidden="true" tabindex="-1"></a>txt_directory <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(), <span class="st">&quot;/Texts&quot;</span>)</span></code></pre></div>
<p>Then, we ask R for a list of all the files in the .pdf directory. This is both to ensure that we are not overlooking anything and to tell R which files are in the folder. Here, setting <code>recurse=FALSE</code> means that we only list the files in the main folder and not any files that are in other folders in this main folder.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="preparing-the-data.html#cb34-1" aria-hidden="true" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(pdf_directory, <span class="at">pattern =</span> <span class="st">&quot;.pdf&quot;</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>, </span>
<span id="cb34-2"><a href="preparing-the-data.html#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-3"><a href="preparing-the-data.html#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="preparing-the-data.html#cb34-4" aria-hidden="true" tabindex="-1"></a>files</span></code></pre></div>
<p>While we could convert a single document at a time, more often we have to deal with more than one document. To read all documents in at once, we have to write a little function. This function does the following. First, we tell R to make a new function that we label <code>extract</code>, and as input give it an element we call <code>filename</code>. This filename is at this point an empty element, but to which we will later refer the files we want to extract. Then, we tell it to print the file name to ensure that we are working with the right files while the function is running. In the next step, we tell it to try to read this filename using the <code>pdf_text</code> function and save the result as a file called <code>text</code>. Afterwards, we tell it to do so for each of the files that end on .pdf that are in the element <code>files</code>. Then, we have it write this text file to a new file. This file is the extracted .pdf in .txt form:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="preparing-the-data.html#cb35-1" aria-hidden="true" tabindex="-1"></a>extract <span class="ot">&lt;-</span> <span class="cf">function</span>(filename) {</span>
<span id="cb35-2"><a href="preparing-the-data.html#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(filename)</span>
<span id="cb35-3"><a href="preparing-the-data.html#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">try</span>({</span>
<span id="cb35-4"><a href="preparing-the-data.html#cb35-4" aria-hidden="true" tabindex="-1"></a>        text <span class="ot">&lt;-</span> <span class="fu">pdf_text</span>(filename)</span>
<span id="cb35-5"><a href="preparing-the-data.html#cb35-5" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb35-6"><a href="preparing-the-data.html#cb35-6" aria-hidden="true" tabindex="-1"></a>    title <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;(.*)/([^/]*).pdf&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">2&quot;</span>, filename)</span>
<span id="cb35-7"><a href="preparing-the-data.html#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write</span>(text, <span class="fu">file.path</span>(txt_directory, <span class="fu">paste0</span>(title, <span class="st">&quot;.txt&quot;</span>)))</span>
<span id="cb35-8"><a href="preparing-the-data.html#cb35-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We then use this function to extract all the pdf files in the <code>pdf_directory</code> folder. To do so, we use a <code>for</code> loop. The logic of this loop is that for each individual <code>file</code> in the element <code>files</code>, we run the <code>extract</code> function we created. This will create an element called <code>file</code> for the file R is currently working on, and will create the .txt files in the <code>txt_directory</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="preparing-the-data.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (file <span class="cf">in</span> files) {</span>
<span id="cb36-2"><a href="preparing-the-data.html#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">extract</span>(file)</span>
<span id="cb36-3"><a href="preparing-the-data.html#cb36-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can now read the .txt files into R. To do so, we use <code>paste0(txt_directory, "*")</code> to tell <code>readtext</code> to look into our <code>txt_directory</code>, and read any file in there. Besides this, we need to specify the encoding. Most often, this is <strong>UTF-8</strong>, though sometimes you might find <strong>latin1</strong> or <strong>Windows-1252</strong> encodings. While <code>readtext</code> will convert all these to <strong>UTF-8</strong>, you have to specify the original encoding. To find out which one you need, you have to look into the properties of the .txt file.</p>
<p>Assuming our texts are in UTF-8 encoding, we run:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="preparing-the-data.html#cb37-1" aria-hidden="true" tabindex="-1"></a>data_texts <span class="ot">&lt;-</span> <span class="fu">readtext</span>(<span class="fu">paste0</span>(txt_directory, <span class="st">&quot;*&quot;</span>), <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span></code></pre></div>
<p>The result of this is a data frame of texts, which we can transform into a corpus for use in <code>quanteda</code> or keep as it is for other types of analyses.</p>
</div>
<div id="import-.txt-files" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Import .txt Files</h2>
<p>In case that we already have the .txt files somewhere, we can make the above process a bit easier, and begin at the last step:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="preparing-the-data.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readtext)</span>
<span id="cb38-2"><a href="preparing-the-data.html#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="preparing-the-data.html#cb38-3" aria-hidden="true" tabindex="-1"></a>txt_directory <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(), <span class="st">&quot;/Texts&quot;</span>)</span>
<span id="cb38-4"><a href="preparing-the-data.html#cb38-4" aria-hidden="true" tabindex="-1"></a>data_texts <span class="ot">&lt;-</span> <span class="fu">readtext</span>(<span class="fu">paste0</span>(txt_directory, <span class="st">&quot;*&quot;</span>), <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span></code></pre></div>
</div>
<div id="import-.csv-files" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Import .csv Files</h2>
<p>We can also choose not to import the texts into R in a direct fashion, but import a .csv file with word counts instead. One way to generate these counts is by using JFreq <span class="citation">(<a href="references.html#ref-Lowe2011b" role="doc-biblioref">Lowe 2011</a>)</span>. This is a useful stand-alone programme written in Java that generates a .csv file where the rows represent the documents and the columns represent the individual words contained in the documents. The cells therefore, contain the wordcounts for each word within each document. JFreq also allows performing some basic pre-processing. JFreq is not actively maintained, but is available at <a href="https://conjugateprior.org/software/jfreq/" class="uri">https://conjugateprior.org/software/jfreq/</a>.</p>
<p>To use JFreq, open the programme and drag and drop all the documents you want to process into the window of the programme. Once you do this, the document file names will appear in the document window. Then, you can choose from several pre-processing options. Amongst these are options to make all words lowercase or remove numbers, currency symbols, or stop words. The latter are words that often appear in texts which do not carry an important meaning. These are words such as <code>and'',</code>or’’ and ``but’’. As stop words are language-specific and often context-specific as well, we need to tell JFreq what words are stop words. We can do so by putting all the stop words in a separate .txt file and load it in JFreq. You can also find many lists of stopwords for different languages online. For instance, many different lists of stopwords in English are available in this GitHub page: <a href="https://github.com/igorbrigadir/stopwords" class="uri">https://github.com/igorbrigadir/stopwords</a> Finally, we can apply a stemmer which reduces words such as Europe and European to a single Europ* stem. JFreq allows us to use pre-defined stemmers by choosing the relevant language from a drop-down menu. In the following screenshot, you can see the JFreq at work importing the .txt files of a number of election manifestos.</p>
<p><img src="figures/jfreq.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Note that here the encoding is UTF-8 while the locale is English (UK). Once we have specified all the options we want, we give a name for the output folder and press <em>Process</em>. Now we go to that folder we named and copy-paste the ``data.csv’’ file into your Working Directory. In R, we then run the following:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="preparing-the-data.html#cb39-1" aria-hidden="true" tabindex="-1"></a>data_manifestos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>By specifying <code>row.names=1</code>, we store the information of the first column in the data frame itself. This column, containing the names of the documents now belongs to the object of the data frame and does not appear as a separate column. The same is true for <code>header=TRUE</code> which ensures that the first row gives names to the columns (in this case containing the words).</p>
</div>
<div id="import-using-web-scraping" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Import using Web Scraping</h2>
<p>If our text is online (e.g. as part of a website) we can also choose to get it from there without copying it into a .txt file first. To do so, we have to employ web scraping. The logic of web scraping is that we use the structure of the underlying HTML document to find and download the text we want. Note though that not all websites encourage (or even allow) scraping. So, do have a look at their disclaimer before we do so. You can do this by either checking the website’s <em>terms and condition</em> page, or the robots.txt file that you can usually find appended at the home page (e.g. <a href="https://www.facebook.com/robots.txt" class="uri">https://www.facebook.com/robots.txt</a> ).</p>
<p>In the following example we will see how one can download information from the Internet Movie Database (IMDb): <a href="https://www.imdb.com" class="uri">https://www.imdb.com</a> Note that the IMDb does not allow you to do any web scraping, so the following example is given for illustration purposes only! If you are interested in analyzing data from IMDB you can download the official datasets that are released by IMDB here: <a href="https://datasets.imdbws.com/" class="uri">https://datasets.imdbws.com/</a> The documentation for these datasets is available here: <a href="https://www.imdb.com/interfaces/" class="uri">https://www.imdb.com/interfaces/</a> If you would like to learn more about web scraping in the context of quantitative text analysis we suggest the textbook by <span class="citation"><a href="references.html#ref-Munzert2014" role="doc-biblioref">Munzert et al.</a> (<a href="references.html#ref-Munzert2014" role="doc-biblioref">2014</a>)</span>.</p>
<p>In the following example we show how to download the user reviews that appear on the IMDB website. The first command, <code>read_html</code> downloads this whole page. If you look at this page in your browser, you see that there are many other things on there besides the user review. To tell R which part is the text to download, we use the <code>html_nodes</code> command. This command looks for a certain header on the HTML page and starts downloading from there. The <code>html_text</code> command then reads that bit of text and puts it into the object. Note that the <code>%&gt;%</code> command we use here is what we call a <em>pipe</em>. What it does is that it transports the output of one command into another, without saving it to an intermediate object. So here, we first download the HTML, find the right header, and only then save it into an object. Having done this for three reviews, we then bind them together:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="preparing-the-data.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb40-2"><a href="preparing-the-data.html#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="preparing-the-data.html#cb40-3" aria-hidden="true" tabindex="-1"></a>review1 <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;http://www.imdb.com/title/tt1979376/&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="preparing-the-data.html#cb40-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">html_nodes</span>(<span class="st">&quot;#titleUserReviewsTeaser p&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="preparing-the-data.html#cb40-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">html_text</span>()</span>
<span id="cb40-6"><a href="preparing-the-data.html#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="preparing-the-data.html#cb40-7" aria-hidden="true" tabindex="-1"></a>review2 <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;http://www.imdb.com/title/tt6806448/&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="preparing-the-data.html#cb40-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">html_nodes</span>(<span class="st">&quot;#titleUserReviewsTeaser p&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="preparing-the-data.html#cb40-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">html_text</span>()</span>
<span id="cb40-10"><a href="preparing-the-data.html#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="preparing-the-data.html#cb40-11" aria-hidden="true" tabindex="-1"></a>review3 <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;http://www.imdb.com/title/tt7131622/&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-12"><a href="preparing-the-data.html#cb40-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">html_nodes</span>(<span class="st">&quot;#titleUserReviewsTeaser p&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-13"><a href="preparing-the-data.html#cb40-13" aria-hidden="true" tabindex="-1"></a> <span class="fu">html_text</span>()</span>
<span id="cb40-14"><a href="preparing-the-data.html#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="preparing-the-data.html#cb40-15" aria-hidden="true" tabindex="-1"></a>reviews_scraping <span class="ot">&lt;-</span> <span class="fu">c</span>(review1, review2, review3)</span></code></pre></div>
</div>
<div id="import-from-an-api" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Import from an API</h2>
<p>Instead of importing the online data page-by-page, we can also use special programmes to download lots of data at once. We can do so with an Application Programming Interface (API). The main difference between using an API and regular webscraping is that APIs are specifically designed for this purpose. This means that it is easier for R to read the webpages, and that you can download a large amount of data at once. APIs are offered by many popular web sites like Wikipedia, social networking sites like Twitter and Facebook, newspapers such as <em>The New York Times</em>, and so on.</p>
<p>While almost all websites can be read by the <code>rvest</code> package, for the APIs you often need a specific package. For example, for Twitter there is the <code>rtweet</code> package, for Facebook <code>rFacebook</code>, and <code>ggmap</code> for Google maps. Also, you often, if not always, need to register first before you can use an API. Note, however, that Facebook has recently taken steps in restricting access to their public APIs for research purposes, which means that research on Facebook users’ posts is no longer an option (see <span class="citation"><a href="references.html#ref-Freelon2018" role="doc-biblioref">Freelon</a> (<a href="references.html#ref-Freelon2018" role="doc-biblioref">2018</a>)</span> and <span class="citation"><a href="references.html#ref-Perriam2020" role="doc-biblioref">Perriam, Birkbak, and Freeman</a> (<a href="references.html#ref-Perriam2020" role="doc-biblioref">2020</a>)</span>).</p>
<p>Having said this, however, there are many APIs with associated R packages that are made by researchers and for researchers. One such example in the area of quantitative text analysis is the API and <code>manifestoR</code> package developed by the Manifesto Project, a longstanding research project previously known as the Manifesto Research Group (MRG), Comparative Manifestos Project (CMP), and Manifesto Research on Political Representation (MARPOR).</p>
<p>The Manifesto Project collects the electoral manifestos that have been released by major parties across the OECD countries since 1945, and trains human coders to classify their content using a custom-made coding scheme <span class="citation">(<a href="references.html#ref-Volkens2019a" role="doc-biblioref">Volkens et al. 2019</a>)</span>. Using the Manifesto Project API we can download the text of many of these manifestos along with the annotations made by the trained coders (see <span class="citation"><a href="references.html#ref-Merz2016" role="doc-biblioref">Merz, Regel, and Lewandowski</a> (<a href="references.html#ref-Merz2016" role="doc-biblioref">2016</a>)</span>). In the following example we do this using the <code>manifestoR</code> package.</p>
<p>Before you can use the API, you first need to register with the Manifesto Project. For this, go to their website (<a href="https://manifesto-project.wzb.eu/" class="uri">https://manifesto-project.wzb.eu/</a>), click on the <em>Login/Sign-up</em> button, and choose <em>Register</em>. As soon as you then have confirmed your account using the confirmation e-mail, you can then login to your account and go to your profile page. Here you can see your API key, which you can download. Do so, and save the file in your Working Directory. If you have forgotten where that is, type <code>getwd()</code> into the console and R will tell you. To load the manifestos into R we then first have to load the package and set the API key:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="preparing-the-data.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(manifestoR)</span>
<span id="cb41-2"><a href="preparing-the-data.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mp_setapikey</span>(<span class="st">&quot;manifesto_apikey.txt&quot;</span>)</span></code></pre></div>
<p>R is now set to use the API for whatever we want. For example, let’s download the manifesto (and the corresponding codes) for the FDP in Germany, which has the code 41420 in the Manifesto Project, for the electing in September 2017:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="preparing-the-data.html#cb42-1" aria-hidden="true" tabindex="-1"></a>corpus_fdp <span class="ot">&lt;-</span> <span class="fu">mp_corpus</span>(party <span class="sc">==</span> <span class="dv">41420</span> <span class="sc">&amp;</span> date <span class="sc">==</span> <span class="dv">201709</span>)</span></code></pre></div>
<p>As you can see, the <code>corpus_fdp</code> object now contains all the relevant information.</p>
<p>So, what do we do when there is no R package available? In that case, we can still get the data into R, but it involves slightly more work. Let’s look at an example using an API from the Police in the United Kingdom (<a href="https://data.police.uk/docs/" class="uri">https://data.police.uk/docs/</a>). If you look at the website, you find that we can get information ranging from street-level crimes to stop-and-searches. If you click any of the links, you can also see what kind of information we will be <em>receiving</em> and what kind of information we need to <em>provide</em>. Let’s start by loading the packages:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="preparing-the-data.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb43-2"><a href="preparing-the-data.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb43-3"><a href="preparing-the-data.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span></code></pre></div>
<p>Let’s see if we can get an overview of all the crimes on a street-level. When on the main page we select <strong>Street level crimes</strong> we find that we have to set the API to <a href="https://data.police.uk/api/crimes-street/all-crime" class="uri">https://data.police.uk/api/crimes-street/all-crime</a>?. Let’s store this address in an object so its easier to work with later:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="preparing-the-data.html#cb44-1" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;https://data.police.uk/api/crimes-street/all-crime?&quot;</span></span></code></pre></div>
<p>We can then build our request. As you can see on the site, the request requires us to specify the latitude and longitude of the place we are interested in and optionally the date. We set these here:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="preparing-the-data.html#cb45-1" aria-hidden="true" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="at">url =</span> path,</span>
<span id="cb45-2"><a href="preparing-the-data.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="at">query =</span> <span class="fu">list</span>(</span>
<span id="cb45-3"><a href="preparing-the-data.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="at">lat =</span> <span class="fl">51.523772</span>,</span>
<span id="cb45-4"><a href="preparing-the-data.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="at">lng =</span> <span class="sc">-</span><span class="fl">0.158539</span>)</span>
<span id="cb45-5"><a href="preparing-the-data.html#cb45-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>We can then send our request. Here, we do this with the <code>content</code> command, which takes as its input the request we just set up, as well as the way we want our data (in text form) and the encoding (here UTF-8):</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="preparing-the-data.html#cb46-1" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">content</span>(request, <span class="at">as =</span> <span class="st">&quot;text&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span></code></pre></div>
<p>The result is a JSON object that you can see in the environment. While JSON (JavaScript Object Notation) is a generic way in which information is easy to share - and is thus often used - it is not in an ideal form. So, we change the JSON information to a data frame using the following:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="preparing-the-data.html#cb47-1" aria-hidden="true" tabindex="-1"></a>data_crimes <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(response, <span class="at">flatten =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="preparing-the-data.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>()</span></code></pre></div>
<p>You can now find all the information in the new <code>data_crimes</code> object, which contains information about the type of crime, location, month etc. This is one example of an API, but there are many others available, such as those of the EU, OpenStreetMaps, Weather Underground, etc. As we can see though, having a package makes things easier, though more limited.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="getting-ready.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reliability-and-validity.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Quantitative Text Analysis.pdf", "Quantitative Text Analysis.epub"],
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
