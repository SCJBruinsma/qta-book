<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="6.2 Sentiment Analysis | Quantitative Text Analysis" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Theory and Methods for Quantitative Text Analysis" />


<meta name="author" content="Kostas Gemenis &amp; Bastiaan Bruinsma" />

<meta name="date" content="2021-07-28" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Theory and Methods for Quantitative Text Analysis">

<title>6.2 Sentiment Analysis | Quantitative Text Analysis</title>

<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 2em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#welcome">Welcome!</a></li>
<li><a href="1-getting-started.html#getting-started"><span class="toc-section-number">1</span> Getting Started</a>
<ul>
<li><a href="1-1-r-on-windows.html#r-on-windows"><span class="toc-section-number">1.1</span> R on Windows</a></li>
<li><a href="1-2-r-on-linux.html#r-on-linux"><span class="toc-section-number">1.2</span> R on Linux</a></li>
<li><a href="1-3-r-on-macos.html#r-on-macos"><span class="toc-section-number">1.3</span> R on macOS</a></li>
<li><a href="1-4-r-in-the-cloud.html#r-in-the-cloud"><span class="toc-section-number">1.4</span> R in the Cloud</a></li>
</ul></li>
<li><a href="2-installing-packages.html#installing-packages"><span class="toc-section-number">2</span> Installing Packages</a>
<ul>
<li><a href="2-1-installing-from-cran.html#installing-from-cran"><span class="toc-section-number">2.1</span> Installing from CRAN</a></li>
<li><a href="2-2-installing-from-github.html#installing-from-github"><span class="toc-section-number">2.2</span> Installing from GitHub</a></li>
<li><a href="2-3-packages-for-quantitative-text-analysis-in-r.html#packages-for-quantitative-text-analysis-in-r"><span class="toc-section-number">2.3</span> Packages for Quantitative Text Analysis in R</a></li>
<li><a href="2-4-issues-bugs-and-errors.html#issues-bugs-and-errors"><span class="toc-section-number">2.4</span> Issues, Bugs and Errors</a></li>
</ul></li>
<li><a href="3-importing-data.html#importing-data"><span class="toc-section-number">3</span> Importing Data</a>
<ul>
<li><a href="3-1-text-in-r.html#text-in-r"><span class="toc-section-number">3.1</span> Text in R</a></li>
<li><a href="3-2-import-txt-files.html#import-.txt-files"><span class="toc-section-number">3.2</span> Import .txt Files</a></li>
<li><a href="3-3-import-pdf-files.html#import-.pdf-files"><span class="toc-section-number">3.3</span> Import .pdf Files</a></li>
<li><a href="3-4-import-csv-files.html#import-.csv-files"><span class="toc-section-number">3.4</span> Import .csv Files</a></li>
<li><a href="3-5-import-from-an-api.html#import-from-an-api"><span class="toc-section-number">3.5</span> Import from an API</a></li>
<li><a href="3-6-import-using-web-scraping.html#import-using-web-scraping"><span class="toc-section-number">3.6</span> Import using Web Scraping</a></li>
</ul></li>
<li><a href="4-reliability-and-validity.html#reliability-and-validity"><span class="toc-section-number">4</span> Reliability and Validity</a>
<ul>
<li><a href="4-1-inter-coder-agreement.html#inter-coder-agreement"><span class="toc-section-number">4.1</span> Inter-Coder Agreement</a></li>
<li><a href="4-2-visualizing-quality.html#visualizing-quality"><span class="toc-section-number">4.2</span> Visualizing Quality</a></li>
</ul></li>
<li><a href="5-preliminaries.html#preliminaries"><span class="toc-section-number">5</span> Preliminaries</a>
<ul>
<li><a href="5-1-the-corpus.html#the-corpus"><span class="toc-section-number">5.1</span> The Corpus</a></li>
<li><a href="5-2-keywords-in-context.html#keywords-in-context"><span class="toc-section-number">5.2</span> Keywords in Context</a></li>
<li><a href="5-3-visualisations-and-descriptives.html#visualisations-and-descriptives"><span class="toc-section-number">5.3</span> Visualisations and Descriptives</a></li>
<li><a href="5-4-text-statistics.html#text-statistics"><span class="toc-section-number">5.4</span> Text Statistics</a></li>
</ul></li>
<li><a href="6-dictionary-analysis.html#dictionary-analysis"><span class="toc-section-number">6</span> Dictionary Analysis</a>
<ul>
<li><a href="6-1-classical-dictionary-analysis.html#classical-dictionary-analysis"><span class="toc-section-number">6.1</span> Classical Dictionary Analysis</a></li>
<li><a href="6-2-sentiment-analysis.html#sentiment-analysis"><span class="toc-section-number">6.2</span> Sentiment Analysis</a>
<ul>
<li><a href="6-2-sentiment-analysis.html#movie-reviews"><span class="toc-section-number">6.2.1</span> Movie Reviews</a></li>
<li><a href="6-2-sentiment-analysis.html#twitter"><span class="toc-section-number">6.2.2</span> Twitter</a></li>
</ul></li>
</ul></li>
<li><a href="7-scaling.html#scaling"><span class="toc-section-number">7</span> Scaling</a>
<ul>
<li><a href="7-1-wordscores.html#wordscores"><span class="toc-section-number">7.1</span> Wordscores</a></li>
<li><a href="7-2-wordfish.html#wordfish"><span class="toc-section-number">7.2</span> Wordfish</a></li>
<li><a href="7-3-correspondence-analysis.html#correspondence-analysis"><span class="toc-section-number">7.3</span> Correspondence Analysis</a></li>
</ul></li>
<li><a href="8-supervised-methods.html#supervised-methods"><span class="toc-section-number">8</span> Supervised Methods</a>
<ul>
<li><a href="8-1-support-vector-machines.html#support-vector-machines"><span class="toc-section-number">8.1</span> Support Vector Machines</a>
<ul>
<li><a href="8-1-support-vector-machines.html#svm-with-rtexttools"><span class="toc-section-number">8.1.1</span> SVM with RTextTools</a></li>
<li><a href="8-1-support-vector-machines.html#svm-with-quanteda"><span class="toc-section-number">8.1.2</span> SVM with Quanteda</a></li>
</ul></li>
<li><a href="8-2-naive-bayes.html#naive-bayes"><span class="toc-section-number">8.2</span> Naive Bayes</a></li>
</ul></li>
<li><a href="9-unsupervised-methods.html#unsupervised-methods"><span class="toc-section-number">9</span> Unsupervised Methods</a>
<ul>
<li><a href="9-1-latent-dirichlet-allocation.html#latent-dirichlet-allocation"><span class="toc-section-number">9.1</span> Latent Dirichlet Allocation</a></li>
<li><a href="9-2-seeded-latent-dirichlet-allocation.html#seeded-latent-dirichlet-allocation"><span class="toc-section-number">9.2</span> Seeded Latent Dirichlet Allocation</a></li>
<li><a href="9-3-structural-topic-model.html#structural-topic-model"><span class="toc-section-number">9.3</span> Structural Topic Model</a></li>
</ul></li>
<li><a href="10-texttricks.html#texttricks"><span class="toc-section-number">10</span> Texttricks</a></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="sentiment-analysis" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Sentiment Analysis</h2>
<p>The logic of dictionaries is that we can use them to see which kind of topics are present in our documents. Yet, we can also use them to provide us with measurements that are most often related to scaling. One way to do so is with <em>sentiment</em> analysis. Here, we look at whether a certain piece of text is happy, angry, positive, negative, and so on. One case in which this can help us is with movie reviews. These reviews give us a description of a movie and then tell us their opinion. Another is when we look at Twitter data, to capture the “mood of the moment.” Here, we will look at both, starting with the movie reviews.</p>
<div id="movie-reviews" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Movie Reviews</h3>
<p>First, we load some reviews into R. The corpus we use here contains 50,000 movie reviews, each with a 1-10 rating (amongst others). As 50,000 reviews make the analysis quite slow, we will first select 30 reviews at random from this corpus. We do so via <code>corpus_sample</code>, after which we transform it via a tokens object into a dfm:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="6-2-sentiment-analysis.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.classifiers)</span>
<span id="cb104-2"><a href="6-2-sentiment-analysis.html#cb104-2" aria-hidden="true" tabindex="-1"></a>reviews <span class="ot">&lt;-</span> <span class="fu">corpus_sample</span>(data_corpus_LMRD, <span class="dv">30</span>)</span>
<span id="cb104-3"><a href="6-2-sentiment-analysis.html#cb104-3" aria-hidden="true" tabindex="-1"></a>reviews_tokens <span class="ot">&lt;-</span> <span class="fu">tokens</span>(reviews)</span>
<span id="cb104-4"><a href="6-2-sentiment-analysis.html#cb104-4" aria-hidden="true" tabindex="-1"></a>reviews_dfm <span class="ot">&lt;-</span> <span class="fu">dfm</span>(reviews_tokens)</span></code></pre></div>
<p>The next step is to load in a sentiment analysis dictionary. Here, we will use the Lexicoder Sentiment Dictionary, included in <code>quanteda</code> and run it on the dfm:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="6-2-sentiment-analysis.html#cb105-1" aria-hidden="true" tabindex="-1"></a>data_dictionary_LSD2015</span>
<span id="cb105-2"><a href="6-2-sentiment-analysis.html#cb105-2" aria-hidden="true" tabindex="-1"></a>results_dfm <span class="ot">&lt;-</span> <span class="fu">dfm_lookup</span>(reviews_dfm, data_dictionary_LSD2015)</span>
<span id="cb105-3"><a href="6-2-sentiment-analysis.html#cb105-3" aria-hidden="true" tabindex="-1"></a>results_dfm</span></code></pre></div>
<p>The next step is to convert the results to a data frame and view them:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="6-2-sentiment-analysis.html#cb106-1" aria-hidden="true" tabindex="-1"></a>sentiment <span class="ot">&lt;-</span> <span class="fu">convert</span>(results_dfm, <span class="at">to=</span><span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb106-2"><a href="6-2-sentiment-analysis.html#cb106-2" aria-hidden="true" tabindex="-1"></a>sentiment</span></code></pre></div>
<pre><code>##                    doc_id negative positive neg_positive neg_negative
## 1    train/neg/5310_1.txt        8        6            0            0
## 2  train/pos/11320_10.txt        0        9            0            0
## 3    train/neg/6413_3.txt        5       10            0            0
## 4    train/neg/5700_1.txt       11       19            0            0
## 5  train/pos/10794_10.txt        1        6            0            0
## 6     test/neg/9484_2.txt        3        7            0            0
## 7   train/pos/2214_10.txt        5        8            0            0
## 8   train/pos/9523_10.txt        4       24            0            0
## 9    test/pos/10466_8.txt        2        6            0            0
## 10    test/pos/3493_9.txt        6       14            0            0
## 11   train/neg/1251_4.txt        4        1            0            0
## 12    test/neg/5299_2.txt       13        5            0            0
## 13  train/pos/2774_10.txt       10        9            0            0
## 14   train/neg/5388_2.txt       26       18            0            0
## 15   train/pos/8952_7.txt        7       18            0            0
## 16   test/pos/6552_10.txt       11        6            0            0
## 17   train/pos/9549_8.txt        5       15            0            0
## 18  train/pos/2437_10.txt        9        8            0            0
## 19   train/neg/7808_1.txt       13        8            0            0
## 20   train/neg/2495_4.txt       29       25            0            0
## 21    test/pos/7843_8.txt       12       24            0            0
## 22    test/neg/7659_3.txt        7        3            0            0
## 23  train/pos/7726_10.txt       19       20            0            0
## 24    test/pos/1171_8.txt       10       20            0            0
## 25   test/pos/8746_10.txt       10       12            0            0
## 26    test/pos/8933_8.txt        4       11            0            0
## 27   train/neg/6806_1.txt       11        8            0            0
## 28   test/pos/5307_10.txt        1        6            0            0
## 29  train/neg/12004_4.txt        4       10            0            0
## 30   test/pos/7043_10.txt        3        7            0            0</code></pre>
<p>Since movie reviews usually come with some sort of rating (often in the form of stars), we can see if this relates to the sentiment of the review. To do so, we have to take the rating out of the dfm and place it in a new data frame with the positive and negative sentiments:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="6-2-sentiment-analysis.html#cb108-1" aria-hidden="true" tabindex="-1"></a>star_data <span class="ot">&lt;-</span> reviews_dfm<span class="sc">@</span>docvars<span class="sc">$</span>rating</span>
<span id="cb108-2"><a href="6-2-sentiment-analysis.html#cb108-2" aria-hidden="true" tabindex="-1"></a>stargraph <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(star_data, sentiment<span class="sc">$</span>negative, sentiment<span class="sc">$</span>positive))</span>
<span id="cb108-3"><a href="6-2-sentiment-analysis.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(stargraph) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;stars&quot;</span>,<span class="st">&quot;negative&quot;</span>,<span class="st">&quot;positive&quot;</span>)</span></code></pre></div>
<p>To compare the sentiment with the stars, we first have to combine the senitments into a scale. Of the many ways to do so, the simplest is to take the difference between the positive and negative words (positive – negative). Another option is to take the ratio of positive words against both positive and negative (positive/positive+negative). Here, we do both:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="6-2-sentiment-analysis.html#cb109-1" aria-hidden="true" tabindex="-1"></a>sentiment_difference <span class="ot">&lt;-</span> stargraph<span class="sc">$</span>positive <span class="sc">-</span> stargraph<span class="sc">$</span>negative</span>
<span id="cb109-2"><a href="6-2-sentiment-analysis.html#cb109-2" aria-hidden="true" tabindex="-1"></a>sentiment_ratio <span class="ot">&lt;-</span> (stargraph<span class="sc">$</span>positive<span class="sc">/</span>(stargraph<span class="sc">$</span>positive <span class="sc">+</span></span>
<span id="cb109-3"><a href="6-2-sentiment-analysis.html#cb109-3" aria-hidden="true" tabindex="-1"></a>    stargraph<span class="sc">$</span>negative))</span>
<span id="cb109-4"><a href="6-2-sentiment-analysis.html#cb109-4" aria-hidden="true" tabindex="-1"></a>stargraph <span class="ot">&lt;-</span> <span class="fu">cbind</span>(stargraph, sentiment_difference, sentiment_ratio)</span></code></pre></div>
<p>Then, we can plot the ratings and the scaled sentiment measures together with a linear regression line:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="6-2-sentiment-analysis.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb110-2"><a href="6-2-sentiment-analysis.html#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="6-2-sentiment-analysis.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stargraph, <span class="fu">aes</span>(<span class="at">x =</span> sentiment_difference, <span class="at">y =</span> stars)) <span class="sc">+</span></span>
<span id="cb110-4"><a href="6-2-sentiment-analysis.html#cb110-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb110-5"><a href="6-2-sentiment-analysis.html#cb110-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Positive minus Negative&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Stars&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Intro-to-Quantitative-Text-Analysis_files/figure-html/unnamed-chunk-77-1.png" width="672"  /></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="6-2-sentiment-analysis.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stargraph, <span class="fu">aes</span>(<span class="at">x =</span> sentiment_ratio, <span class="at">y =</span> stars)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb112-2"><a href="6-2-sentiment-analysis.html#cb112-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Ratio of Positive to Total&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-3"><a href="6-2-sentiment-analysis.html#cb112-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Stars&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Intro-to-Quantitative-Text-Analysis_files/figure-html/unnamed-chunk-78-1.png" width="672"  /></p>
<p>Finally, let us look at how we can make any more inferences, by estimating confidence intervals around the point estimates. For this, we again add a column, this time one with the total of positive and negative words as scored by the dictionary. We do so by copying the data frame to a new data frame and adding a new column filled with NA values:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="6-2-sentiment-analysis.html#cb114-1" aria-hidden="true" tabindex="-1"></a>reviews_bootstrap <span class="ot">&lt;-</span> sentiment</span>
<span id="cb114-2"><a href="6-2-sentiment-analysis.html#cb114-2" aria-hidden="true" tabindex="-1"></a>reviews_bootstrap<span class="sc">$</span>n <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>We then again specify the number of reviews, the replications that we want and change the data frame into an array:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="6-2-sentiment-analysis.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(combinat)</span>
<span id="cb115-2"><a href="6-2-sentiment-analysis.html#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="6-2-sentiment-analysis.html#cb115-3" aria-hidden="true" tabindex="-1"></a>nman <span class="ot">&lt;-</span> <span class="fu">nrow</span>(reviews_bootstrap)</span>
<span id="cb115-4"><a href="6-2-sentiment-analysis.html#cb115-4" aria-hidden="true" tabindex="-1"></a>nrepl <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb115-5"><a href="6-2-sentiment-analysis.html#cb115-5" aria-hidden="true" tabindex="-1"></a>manifBSn <span class="ot">&lt;-</span> manifBSnRand <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">as.matrix</span>(reviews_bootstrap[,</span>
<span id="cb115-6"><a href="6-2-sentiment-analysis.html#cb115-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]), <span class="fu">c</span>(nman, <span class="dv">2</span>, nrepl <span class="sc">+</span> <span class="dv">1</span>), <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>nman, <span class="fu">names</span>(reviews_bootstrap[,</span>
<span id="cb115-7"><a href="6-2-sentiment-analysis.html#cb115-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]), <span class="dv">0</span><span class="sc">:</span>nrepl))</span></code></pre></div>
<p>Then, we bootstrap the word counts for each movie review and compute percentages for each category using a multinomial draw:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="6-2-sentiment-analysis.html#cb116-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">apply</span>(manifBSn[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(manifBSn), , <span class="dv">1</span>], <span class="dv">1</span>, sum)</span>
<span id="cb116-2"><a href="6-2-sentiment-analysis.html#cb116-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> manifBSn[, , <span class="dv">1</span>]<span class="sc">/</span>n</span>
<span id="cb116-3"><a href="6-2-sentiment-analysis.html#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="6-2-sentiment-analysis.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nrepl) {</span>
<span id="cb116-5"><a href="6-2-sentiment-analysis.html#cb116-5" aria-hidden="true" tabindex="-1"></a>    manifBSn[, , i] <span class="ot">&lt;-</span> <span class="fu">rmultinomial</span>(n, p)</span>
<span id="cb116-6"><a href="6-2-sentiment-analysis.html#cb116-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can then ask R to compute the quantities of interest. These are standard errors for each category, as well as the percentage coded for each category.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="6-2-sentiment-analysis.html#cb117-1" aria-hidden="true" tabindex="-1"></a>NegativeSE <span class="ot">&lt;-</span> <span class="fu">apply</span>(manifBSn[, <span class="st">&quot;negative&quot;</span>, ]<span class="sc">/</span>n <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>, sd)</span>
<span id="cb117-2"><a href="6-2-sentiment-analysis.html#cb117-2" aria-hidden="true" tabindex="-1"></a>PositiveSE <span class="ot">&lt;-</span> <span class="fu">apply</span>(manifBSn[, <span class="st">&quot;positive&quot;</span>, ]<span class="sc">/</span>n <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>, sd)</span>
<span id="cb117-3"><a href="6-2-sentiment-analysis.html#cb117-3" aria-hidden="true" tabindex="-1"></a>perNegative <span class="ot">&lt;-</span> <span class="fu">apply</span>(manifBSn[, <span class="st">&quot;negative&quot;</span>, ]<span class="sc">/</span>n <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>, mean)</span>
<span id="cb117-4"><a href="6-2-sentiment-analysis.html#cb117-4" aria-hidden="true" tabindex="-1"></a>perPositive <span class="ot">&lt;-</span> <span class="fu">apply</span>(manifBSn[, <span class="st">&quot;positive&quot;</span>, ]<span class="sc">/</span>n <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>, mean)</span></code></pre></div>
<p>We then save these quantities of interest in a new data frame:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="6-2-sentiment-analysis.html#cb118-1" aria-hidden="true" tabindex="-1"></a>dataBS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(reviews_bootstrap[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], NegativeSE,</span>
<span id="cb118-2"><a href="6-2-sentiment-analysis.html#cb118-2" aria-hidden="true" tabindex="-1"></a>    PositiveSE, perNegative, perPositive))</span></code></pre></div>
<p>Then, we first calculate the confidence intervals and add these:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="6-2-sentiment-analysis.html#cb119-1" aria-hidden="true" tabindex="-1"></a>pos_hi <span class="ot">&lt;-</span> dataBS<span class="sc">$</span>perPositive <span class="sc">+</span> (<span class="fl">1.96</span> <span class="sc">*</span> dataBS<span class="sc">$</span>PositiveSE)</span>
<span id="cb119-2"><a href="6-2-sentiment-analysis.html#cb119-2" aria-hidden="true" tabindex="-1"></a>pos_lo <span class="ot">&lt;-</span> dataBS<span class="sc">$</span>perPositive <span class="sc">-</span> (<span class="fl">1.96</span> <span class="sc">*</span> dataBS<span class="sc">$</span>PositiveSE)</span>
<span id="cb119-3"><a href="6-2-sentiment-analysis.html#cb119-3" aria-hidden="true" tabindex="-1"></a>neg_lo <span class="ot">&lt;-</span> dataBS<span class="sc">$</span>perNegative <span class="sc">-</span> (<span class="fl">1.96</span> <span class="sc">*</span> dataBS<span class="sc">$</span>NegativeSE)</span>
<span id="cb119-4"><a href="6-2-sentiment-analysis.html#cb119-4" aria-hidden="true" tabindex="-1"></a>neg_hi <span class="ot">&lt;-</span> dataBS<span class="sc">$</span>perNegative <span class="sc">+</span> (<span class="fl">1.96</span> <span class="sc">*</span> dataBS<span class="sc">$</span>NegativeSE)</span>
<span id="cb119-5"><a href="6-2-sentiment-analysis.html#cb119-5" aria-hidden="true" tabindex="-1"></a>dataBS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dataBS, pos_hi, pos_lo, neg_lo, neg_hi)</span></code></pre></div>
<p>Finally, we can then make the graph. Here, we plot each of the positive and negative points and then overlay them with their error bars:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="6-2-sentiment-analysis.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb120-2"><a href="6-2-sentiment-analysis.html#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="6-2-sentiment-analysis.html#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb120-4"><a href="6-2-sentiment-analysis.html#cb120-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">data =</span> dataBS,<span class="fu">aes</span>(<span class="at">x =</span> perPositive, <span class="at">y =</span> doc_id), <span class="at">shape =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb120-5"><a href="6-2-sentiment-analysis.html#cb120-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">data =</span> dataBS,<span class="fu">aes</span>(<span class="at">x =</span> perNegative, <span class="at">y =</span> doc_id), <span class="at">shape =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb120-6"><a href="6-2-sentiment-analysis.html#cb120-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_errorbarh</span>(<span class="at">data =</span> dataBS,<span class="fu">aes</span>(<span class="at">x =</span> perPositive, <span class="at">xmax =</span> pos_hi,<span class="at">xmin =</span> pos_lo, <span class="at">y =</span> doc_id)) <span class="sc">+</span></span>
<span id="cb120-7"><a href="6-2-sentiment-analysis.html#cb120-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_errorbarh</span>(<span class="at">data =</span> dataBS,<span class="fu">aes</span>(<span class="at">x =</span> perNegative, <span class="at">xmax =</span> neg_hi,<span class="at">xmin =</span> neg_lo, <span class="at">y =</span> doc_id)) <span class="sc">+</span></span>
<span id="cb120-8"><a href="6-2-sentiment-analysis.html#cb120-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">xlab</span>(<span class="st">&quot;Percent positive/negative with 95% CIs&quot;</span>) <span class="sc">+</span></span>
<span id="cb120-9"><a href="6-2-sentiment-analysis.html#cb120-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">ylab</span>(<span class="st">&quot;review&quot;</span>)<span class="sc">+</span></span>
<span id="cb120-10"><a href="6-2-sentiment-analysis.html#cb120-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="Intro-to-Quantitative-Text-Analysis_files/figure-html/unnamed-chunk-85-1.png" width="672"  /></p>
<p>As we can see in this particular example, the fact that some documents are shorter than others introduces a lot of uncertainty in the estimates. As evident from the overlapping confidence intervals, for most reviews, the percentage of negative words is not very different from the percentage of positive words. In other words: the sentiment for these reviews is rather mixed.</p>
</div>
<div id="twitter" class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Twitter</h3>
<p>Now, let us turn to an example using Twitter data. Here, we will look at the major problems that have occurred to several of the major US airlines. For this, researchers scraped data from Twitter between 16 and 24 February of 2015. Then, using the Crowdflower platform, they asked contributors to classify each tweet (their sentiment) as either negative, positive, or neutral, and, if negative, what their reason was for classifying it as such. Besides this, the data also contains information on how “confident” coders were about their classification and reason, some information on the Airline, and some info on the Tweet. Finally, we get some information on the “gold” tweets, which Crowdflower uses to figure out how well their coders are doing.</p>
<p>While we can download the data from its website (<a href="https://www.kaggle.com/crowdflower/twitter-airline-sentiment" class="uri">https://www.kaggle.com/crowdflower/twitter-airline-sentiment</a>), for ease-of-use, we also placed it on GitHub:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="6-2-sentiment-analysis.html#cb121-1" aria-hidden="true" tabindex="-1"></a>urlfile <span class="ot">=</span> <span class="st">&quot;https://raw.githubusercontent.com/SCJBruinsma/qta-files/master/Tweets.csv&quot;</span></span>
<span id="cb121-2"><a href="6-2-sentiment-analysis.html#cb121-2" aria-hidden="true" tabindex="-1"></a>tweets <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">url</span>(urlfile))</span></code></pre></div>
<p>Given that this is Twitter data, we have to do quite some cleaning to filter out everything we do not want. While we earlier saw that we can perform cleaning on a corpus, we can also clean our text while still in a data frame. We can do this with R’s in-house <code>gsub</code> command, which can replace any part of a string. To understand how this works, say that we want to remove all the mentions of websites from our tweets. We then do as such:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="6-2-sentiment-analysis.html#cb122-1" aria-hidden="true" tabindex="-1"></a>tweets<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;http.*&quot;</span>,<span class="st">&quot;&quot;</span>, tweets<span class="sc">$</span>text)</span></code></pre></div>
<p>Thus, we substitute those strings that start with "http.*" (the asterisk denotes a wildcard, which means that anything can follow) and replace it with "" (that is, nothing). We do this for any string that is in <code>tweets$text</code>. Using this technique, we also remove slashes, punctuation, various symbols, “RT” (retweets), and references (“href”):</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="6-2-sentiment-analysis.html#cb123-1" aria-hidden="true" tabindex="-1"></a>tweets<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;https.*&quot;</span>,<span class="st">&quot;&quot;</span>, tweets<span class="sc">$</span>text)</span>
<span id="cb123-2"><a href="6-2-sentiment-analysis.html#cb123-2" aria-hidden="true" tabindex="-1"></a>tweets<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">$&quot;</span>, <span class="st">&quot;&quot;</span>, tweets<span class="sc">$</span>text) </span>
<span id="cb123-3"><a href="6-2-sentiment-analysis.html#cb123-3" aria-hidden="true" tabindex="-1"></a>tweets<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;@</span><span class="sc">\\</span><span class="st">w+&quot;</span>, <span class="st">&quot;&quot;</span>, tweets<span class="sc">$</span>text) </span>
<span id="cb123-4"><a href="6-2-sentiment-analysis.html#cb123-4" aria-hidden="true" tabindex="-1"></a>tweets<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;[[:punct:]]&quot;</span>, <span class="st">&quot;&quot;</span>, tweets<span class="sc">$</span>text) </span>
<span id="cb123-5"><a href="6-2-sentiment-analysis.html#cb123-5" aria-hidden="true" tabindex="-1"></a>tweets<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;[ |</span><span class="sc">\t</span><span class="st">]{2,}&quot;</span>, <span class="st">&quot;&quot;</span>, tweets<span class="sc">$</span>text) </span>
<span id="cb123-6"><a href="6-2-sentiment-analysis.html#cb123-6" aria-hidden="true" tabindex="-1"></a>tweets<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;^ &quot;</span>, <span class="st">&quot;&quot;</span>, tweets<span class="sc">$</span>text) </span>
<span id="cb123-7"><a href="6-2-sentiment-analysis.html#cb123-7" aria-hidden="true" tabindex="-1"></a>tweets<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot; $&quot;</span>, <span class="st">&quot;&quot;</span>, tweets<span class="sc">$</span>text) </span>
<span id="cb123-8"><a href="6-2-sentiment-analysis.html#cb123-8" aria-hidden="true" tabindex="-1"></a>tweets<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;RT&quot;</span>, <span class="st">&quot;&quot;</span>, tweets<span class="sc">$</span>text) </span>
<span id="cb123-9"><a href="6-2-sentiment-analysis.html#cb123-9" aria-hidden="true" tabindex="-1"></a>tweets<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;href&quot;</span>, <span class="st">&quot;&quot;</span>, tweets<span class="sc">$</span>text)</span></code></pre></div>
<p>We then transform our dataframe into a corpus (specifying that our text is in the <code>tweets$text</code> field), transform this into a tokens object, lower all the words, remove the stop words, and finally make it into a dfm:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="6-2-sentiment-analysis.html#cb124-1" aria-hidden="true" tabindex="-1"></a>corpus_tweets <span class="ot">&lt;-</span> <span class="fu">corpus</span>(tweets, <span class="at">text_field =</span> <span class="st">&quot;text&quot;</span>)</span>
<span id="cb124-2"><a href="6-2-sentiment-analysis.html#cb124-2" aria-hidden="true" tabindex="-1"></a>data_tweets_tokens <span class="ot">&lt;-</span> <span class="fu">tokens</span>(corpus_tweets)</span>
<span id="cb124-3"><a href="6-2-sentiment-analysis.html#cb124-3" aria-hidden="true" tabindex="-1"></a>data_tweets_tokens <span class="ot">&lt;-</span> <span class="fu">tokens_tolower</span>(data_tweets_tokens, <span class="at">keep_acronyms =</span> <span class="cn">TRUE</span>)</span>
<span id="cb124-4"><a href="6-2-sentiment-analysis.html#cb124-4" aria-hidden="true" tabindex="-1"></a>data_tweets_tokens <span class="ot">&lt;-</span> <span class="fu">tokens_select</span>(data_tweets_tokens, <span class="fu">stopwords</span>(<span class="st">&quot;english&quot;</span>), <span class="at">selection =</span> <span class="st">&quot;remove&quot;</span>)</span>
<span id="cb124-5"><a href="6-2-sentiment-analysis.html#cb124-5" aria-hidden="true" tabindex="-1"></a>data_tweets_dfm <span class="ot">&lt;-</span> <span class="fu">dfm</span>(data_tweets_tokens)</span></code></pre></div>
<p>Now we can apply our dictionary. We can do this in two ways: applying it to the dfm, or applying it to the tokens object. Both should give roughly similar results. Yet, given that <code>dfm_lookup()</code> cannot detect multi-word expressions (as the dfm gets rid of all word order), we can use the <code>tokens_lookup()</code> and then convert this into a dfm, to compensate for this. One reason to do this here is that the LSD2015 dictionary contains some multi-word expressions that <code>dfm_lookup()</code> might miss. As a comparison, let us have a look at both:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="6-2-sentiment-analysis.html#cb125-1" aria-hidden="true" tabindex="-1"></a>results_tokens <span class="ot">&lt;-</span> <span class="fu">tokens_lookup</span>(data_tweets_tokens, data_dictionary_LSD2015)</span>
<span id="cb125-2"><a href="6-2-sentiment-analysis.html#cb125-2" aria-hidden="true" tabindex="-1"></a>results_tokens <span class="ot">&lt;-</span> <span class="fu">dfm</span>(results_tokens)</span>
<span id="cb125-3"><a href="6-2-sentiment-analysis.html#cb125-3" aria-hidden="true" tabindex="-1"></a>results_tokens <span class="ot">&lt;-</span> <span class="fu">convert</span>(results_tokens, <span class="at">to=</span><span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb125-4"><a href="6-2-sentiment-analysis.html#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="6-2-sentiment-analysis.html#cb125-5" aria-hidden="true" tabindex="-1"></a>results_dfm <span class="ot">&lt;-</span> <span class="fu">dfm_lookup</span>(data_tweets_dfm, data_dictionary_LSD2015)</span>
<span id="cb125-6"><a href="6-2-sentiment-analysis.html#cb125-6" aria-hidden="true" tabindex="-1"></a>results_dfm <span class="ot">&lt;-</span> <span class="fu">convert</span>(results_dfm, <span class="at">to=</span><span class="st">&quot;data.frame&quot;</span>)</span></code></pre></div>
<p>Now let us see how well our dictionary has done. To see this, we compare the sentiment of the tweet according to the dictionary with the sentiment assigned by the coder. We take this information out of our original data, and recode it (so it has got numerical values):</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="6-2-sentiment-analysis.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div>
<pre><code>## Caricamento del pacchetto richiesto: carData</code></pre>
<pre><code>## 
## Caricamento pacchetto: &#39;car&#39;</code></pre>
<pre><code>## Il seguente oggetto è mascherato da &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## Il seguente oggetto è mascherato da &#39;package:purrr&#39;:
## 
##     some</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="6-2-sentiment-analysis.html#cb131-1" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> tweets<span class="sc">$</span>airline_sentiment</span>
<span id="cb131-2"><a href="6-2-sentiment-analysis.html#cb131-2" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">recode</span>(labels, <span class="st">&quot;&#39;positive&#39;=1;&#39;negative&#39;=-1;&#39;neutral&#39;=0&quot;</span>)</span>
<span id="cb131-3"><a href="6-2-sentiment-analysis.html#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(labels)</span></code></pre></div>
<p>A quick look at the data (with <code>table()</code>) reveals that the majority of the tweets are negative, a fair share neutral, and finally some positive ones. Now, let us bind this data to the output of our dictionary analysis, and calculate an overall score for each tweet. We do this by subtracting the positive score from the negative score (that is, the higher the score, the more positive the tweet):</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="6-2-sentiment-analysis.html#cb132-1" aria-hidden="true" tabindex="-1"></a>comparison_tokens <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(results_tokens<span class="sc">$</span>positive, results_tokens<span class="sc">$</span>negative, labels))</span>
<span id="cb132-2"><a href="6-2-sentiment-analysis.html#cb132-2" aria-hidden="true" tabindex="-1"></a>difference_tokens <span class="ot">&lt;-</span> results_tokens<span class="sc">$</span>positive <span class="sc">-</span> results_tokens<span class="sc">$</span>negative</span>
<span id="cb132-3"><a href="6-2-sentiment-analysis.html#cb132-3" aria-hidden="true" tabindex="-1"></a>comparison_tokens <span class="ot">&lt;-</span> <span class="fu">cbind</span>(comparison_tokens, difference_tokens)</span>
<span id="cb132-4"><a href="6-2-sentiment-analysis.html#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="6-2-sentiment-analysis.html#cb132-5" aria-hidden="true" tabindex="-1"></a>comparison_dfm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(results_dfm<span class="sc">$</span>positive, results_dfm<span class="sc">$</span>negative, labels))</span>
<span id="cb132-6"><a href="6-2-sentiment-analysis.html#cb132-6" aria-hidden="true" tabindex="-1"></a>difference_dfm <span class="ot">&lt;-</span> results_dfm<span class="sc">$</span>positive <span class="sc">-</span> results_dfm<span class="sc">$</span>negative</span>
<span id="cb132-7"><a href="6-2-sentiment-analysis.html#cb132-7" aria-hidden="true" tabindex="-1"></a>comparison_dfm <span class="ot">&lt;-</span> <span class="fu">cbind</span>(comparison_dfm, difference_dfm)</span></code></pre></div>
<p>Finally, we can place this all in a graph, in which we plot both the human judgement scores and the scores we calculated by subtracting the positive and negative codes. Also, we plot a simple linear equation to better understand the relation:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="6-2-sentiment-analysis.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb133-2"><a href="6-2-sentiment-analysis.html#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="6-2-sentiment-analysis.html#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison_tokens ,<span class="fu">aes</span>(<span class="at">x =</span> difference_tokens, <span class="at">y =</span> labels)) <span class="sc">+</span></span>
<span id="cb133-4"><a href="6-2-sentiment-analysis.html#cb133-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_jitter</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb133-5"><a href="6-2-sentiment-analysis.html#cb133-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb133-6"><a href="6-2-sentiment-analysis.html#cb133-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">xlab</span>(<span class="st">&quot;Positive minus Negative&quot;</span>) <span class="sc">+</span></span>
<span id="cb133-7"><a href="6-2-sentiment-analysis.html#cb133-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">ylab</span>(<span class="st">&quot;Human judgment&quot;</span>) <span class="sc">+</span></span>
<span id="cb133-8"><a href="6-2-sentiment-analysis.html#cb133-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggtitle</span>(<span class="st">&quot;Using Tokens&quot;</span>)<span class="sc">+</span></span>
<span id="cb133-9"><a href="6-2-sentiment-analysis.html#cb133-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_classic</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Intro-to-Quantitative-Text-Analysis_files/figure-html/unnamed-chunk-93-1.png" width="672"  /></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="6-2-sentiment-analysis.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison_dfm, <span class="fu">aes</span>(<span class="at">x =</span> difference_dfm, <span class="at">y =</span> labels)) <span class="sc">+</span></span>
<span id="cb135-2"><a href="6-2-sentiment-analysis.html#cb135-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_jitter</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb135-3"><a href="6-2-sentiment-analysis.html#cb135-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb135-4"><a href="6-2-sentiment-analysis.html#cb135-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">xlab</span>(<span class="st">&quot;Positive minus Negative&quot;</span>) <span class="sc">+</span></span>
<span id="cb135-5"><a href="6-2-sentiment-analysis.html#cb135-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">ylab</span>(<span class="st">&quot;Human Judgment&quot;</span>) <span class="sc">+</span></span>
<span id="cb135-6"><a href="6-2-sentiment-analysis.html#cb135-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggtitle</span>(<span class="st">&quot;Using DFM&quot;</span>)<span class="sc">+</span></span>
<span id="cb135-7"><a href="6-2-sentiment-analysis.html#cb135-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_classic</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Intro-to-Quantitative-Text-Analysis_files/figure-html/unnamed-chunk-93-2.png" width="672"  /></p>
<p>As we can see, there is a positive relation (0.6947 for the tokens and 0.6914 for the dfm), which is quite good considering our approach does not involve any human coders at all.</p>

</div>
</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="6-1-classical-dictionary-analysis.html"><button class="btn btn-default">Previous</button></a>
<a href="7-scaling.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
