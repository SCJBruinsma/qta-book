<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="9.3 Structural Topic Model | Quantitative Text Analysis" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Theory and Methods for Quantitative Text Analysis" />


<meta name="author" content="Kostas Gemenis &amp; Bastiaan Bruinsma" />

<meta name="date" content="2021-07-28" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Theory and Methods for Quantitative Text Analysis">

<title>9.3 Structural Topic Model | Quantitative Text Analysis</title>

<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 2em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#welcome">Welcome!</a></li>
<li><a href="1-getting-started.html#getting-started"><span class="toc-section-number">1</span> Getting Started</a>
<ul>
<li><a href="1-1-r-on-windows.html#r-on-windows"><span class="toc-section-number">1.1</span> R on Windows</a></li>
<li><a href="1-2-r-on-linux.html#r-on-linux"><span class="toc-section-number">1.2</span> R on Linux</a></li>
<li><a href="1-3-r-on-macos.html#r-on-macos"><span class="toc-section-number">1.3</span> R on macOS</a></li>
<li><a href="1-4-r-in-the-cloud.html#r-in-the-cloud"><span class="toc-section-number">1.4</span> R in the Cloud</a></li>
</ul></li>
<li><a href="2-installing-packages.html#installing-packages"><span class="toc-section-number">2</span> Installing Packages</a>
<ul>
<li><a href="2-1-installing-from-cran.html#installing-from-cran"><span class="toc-section-number">2.1</span> Installing from CRAN</a></li>
<li><a href="2-2-installing-from-github.html#installing-from-github"><span class="toc-section-number">2.2</span> Installing from GitHub</a></li>
<li><a href="2-3-packages-for-quantitative-text-analysis-in-r.html#packages-for-quantitative-text-analysis-in-r"><span class="toc-section-number">2.3</span> Packages for Quantitative Text Analysis in R</a></li>
<li><a href="2-4-issues-bugs-and-errors.html#issues-bugs-and-errors"><span class="toc-section-number">2.4</span> Issues, Bugs and Errors</a></li>
</ul></li>
<li><a href="3-importing-data.html#importing-data"><span class="toc-section-number">3</span> Importing Data</a>
<ul>
<li><a href="3-1-text-in-r.html#text-in-r"><span class="toc-section-number">3.1</span> Text in R</a></li>
<li><a href="3-2-import-txt-files.html#import-.txt-files"><span class="toc-section-number">3.2</span> Import .txt Files</a></li>
<li><a href="3-3-import-pdf-files.html#import-.pdf-files"><span class="toc-section-number">3.3</span> Import .pdf Files</a></li>
<li><a href="3-4-import-csv-files.html#import-.csv-files"><span class="toc-section-number">3.4</span> Import .csv Files</a></li>
<li><a href="3-5-import-from-an-api.html#import-from-an-api"><span class="toc-section-number">3.5</span> Import from an API</a></li>
<li><a href="3-6-import-using-web-scraping.html#import-using-web-scraping"><span class="toc-section-number">3.6</span> Import using Web Scraping</a></li>
</ul></li>
<li><a href="4-reliability-and-validity.html#reliability-and-validity"><span class="toc-section-number">4</span> Reliability and Validity</a>
<ul>
<li><a href="4-1-inter-coder-agreement.html#inter-coder-agreement"><span class="toc-section-number">4.1</span> Inter-Coder Agreement</a></li>
<li><a href="4-2-visualizing-quality.html#visualizing-quality"><span class="toc-section-number">4.2</span> Visualizing Quality</a></li>
</ul></li>
<li><a href="5-preliminaries.html#preliminaries"><span class="toc-section-number">5</span> Preliminaries</a>
<ul>
<li><a href="5-1-the-corpus.html#the-corpus"><span class="toc-section-number">5.1</span> The Corpus</a></li>
<li><a href="5-2-keywords-in-context.html#keywords-in-context"><span class="toc-section-number">5.2</span> Keywords in Context</a></li>
<li><a href="5-3-visualisations-and-descriptives.html#visualisations-and-descriptives"><span class="toc-section-number">5.3</span> Visualisations and Descriptives</a></li>
<li><a href="5-4-text-statistics.html#text-statistics"><span class="toc-section-number">5.4</span> Text Statistics</a></li>
</ul></li>
<li><a href="6-dictionary-analysis.html#dictionary-analysis"><span class="toc-section-number">6</span> Dictionary Analysis</a>
<ul>
<li><a href="6-1-classical-dictionary-analysis.html#classical-dictionary-analysis"><span class="toc-section-number">6.1</span> Classical Dictionary Analysis</a></li>
<li><a href="6-2-sentiment-analysis.html#sentiment-analysis"><span class="toc-section-number">6.2</span> Sentiment Analysis</a>
<ul>
<li><a href="6-2-sentiment-analysis.html#movie-reviews"><span class="toc-section-number">6.2.1</span> Movie Reviews</a></li>
<li><a href="6-2-sentiment-analysis.html#twitter"><span class="toc-section-number">6.2.2</span> Twitter</a></li>
</ul></li>
</ul></li>
<li><a href="7-scaling.html#scaling"><span class="toc-section-number">7</span> Scaling</a>
<ul>
<li><a href="7-1-wordscores.html#wordscores"><span class="toc-section-number">7.1</span> Wordscores</a></li>
<li><a href="7-2-wordfish.html#wordfish"><span class="toc-section-number">7.2</span> Wordfish</a></li>
<li><a href="7-3-correspondence-analysis.html#correspondence-analysis"><span class="toc-section-number">7.3</span> Correspondence Analysis</a></li>
</ul></li>
<li><a href="8-supervised-methods.html#supervised-methods"><span class="toc-section-number">8</span> Supervised Methods</a>
<ul>
<li><a href="8-1-support-vector-machines.html#support-vector-machines"><span class="toc-section-number">8.1</span> Support Vector Machines</a>
<ul>
<li><a href="8-1-support-vector-machines.html#svm-with-rtexttools"><span class="toc-section-number">8.1.1</span> SVM with RTextTools</a></li>
<li><a href="8-1-support-vector-machines.html#svm-with-quanteda"><span class="toc-section-number">8.1.2</span> SVM with Quanteda</a></li>
</ul></li>
<li><a href="8-2-naive-bayes.html#naive-bayes"><span class="toc-section-number">8.2</span> Naive Bayes</a></li>
</ul></li>
<li><a href="9-unsupervised-methods.html#unsupervised-methods"><span class="toc-section-number">9</span> Unsupervised Methods</a>
<ul>
<li><a href="9-1-latent-dirichlet-allocation.html#latent-dirichlet-allocation"><span class="toc-section-number">9.1</span> Latent Dirichlet Allocation</a></li>
<li><a href="9-2-seeded-latent-dirichlet-allocation.html#seeded-latent-dirichlet-allocation"><span class="toc-section-number">9.2</span> Seeded Latent Dirichlet Allocation</a></li>
<li><a href="9-3-structural-topic-model.html#structural-topic-model"><span class="toc-section-number">9.3</span> Structural Topic Model</a></li>
</ul></li>
<li><a href="10-texttricks.html#texttricks"><span class="toc-section-number">10</span> Texttricks</a></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="structural-topic-model" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Structural Topic Model</h2>
<p>Besides LDA, various other methods for unsupervised classification exist, such as hierarchical clustering, k-means, and various other mixed membership models. Each of them has its specific advantages and problems, and it often depends on the goal of the researcher to decide which method to use. One new and flexible method is the Structural Topic Model or STM. In R, we can find this method in the <code>stm</code> package <span class="citation">(<label for="tufte-mn-37" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-37" class="margin-toggle">Roberts et al., 2019<span class="marginnote">Roberts, M. E., Stewart, B. M., &amp; Tingley, D. (2019). <span class="nocase">stm: An R Package for Structural Topic Models</span>. <em>Journal of Statistical Software</em>, <em>91</em>(2). <a href="https://doi.org/10.18637/jss.v091.i02">https://doi.org/10.18637/jss.v091.i02</a></span>)</span>.</p>
<p>One of the outstanding features of stm is <em>topical prevalence</em>. This means that we can include covariates to help identify the correct model and better understand the topics the model generates <span class="citation">(<label for="tufte-mn-38" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-38" class="margin-toggle">Roberts et al., 2014<span class="marginnote">Roberts, M. E., Stewart, B. M., Tingley, D., Lucas, C., Leder-Luis, J., Gadarian, S. K., Albertson, B., &amp; Rand, D. G. (2014). Structural topic models for open-ended survey responses. <em>American Journal of Political Science</em>, <em>58</em>(4), 1064–1082. <a href="https://doi.org/10.1111/ajps.12103">https://doi.org/10.1111/ajps.12103</a></span>)</span>. For example, we can add information on time to study how topics change over the years; actors on how they differ between different authors; and any other possible variable to see how they differ between them. One of the main advantages of STM is that, unlike in LDA, we are not required to set any parameters in advance. In LDA, these parameters - <span class="math inline">\(\alpha\)</span> (the degree of mixture of topics a document has) and <span class="math inline">\(\beta\)</span> (the degree of mixture of words that a topic has) - have to be set beforehand based on previous knowledge. Yet, this knowledge is not always present and we often need several iterations before we settle upon a correct number. In STM, we use the metadata to set these parameters.</p>
<div class="figure"><span id="fig:plate-diagram"></span>
<p class="caption marginnote shownote">
Figure 9.1: Plate diagram for a Structucal Topic Model.
</p>
<img src="Intro-to-Quantitative-Text-Analysis_files/figure-html/plate-diagram-1.png" alt="Plate diagram for a Structucal Topic Model." width="90%"  />
</div>
<p>Figure <a href="9-3-structural-topic-model.html#fig:plate-diagram">9.1</a> shows stm in the form of a plate diagram. Here, <span class="math inline">\(X\)</span> refers to the prevalence metadata; <span class="math inline">\(\gamma\)</span>, the metadata weights; <span class="math inline">\(\Sigma\)</span>, the topic covariances; <span class="math inline">\(\theta\)</span>, the document prevalence; <span class="math inline">\(z\)</span>, the per-word topic; <span class="math inline">\(w\)</span>, the observed word; <span class="math inline">\(Y\)</span>, the content metadata; <span class="math inline">\(\beta\)</span>, the topic content; <span class="math inline">\(N\)</span>, the number of words in a document; and <span class="math inline">\(M\)</span>, the number of documents in the corpus.</p>
<p>To run stm in R, we have to load the package, set a seed, convert our dfm to the stm format and place our documents, vocabulary (the tokens) and any other data in three separate objects (for later convenience):</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="9-3-structural-topic-model.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stm)</span></code></pre></div>
<pre><code>## stm v1.3.6 successfully loaded. See ?stm for help. 
##  Papers, resources, and other materials at structuraltopicmodel.com</code></pre>
<pre><code>## 
## Caricamento pacchetto: &#39;stm&#39;</code></pre>
<pre><code>## Il seguente oggetto è mascherato da &#39;package:lattice&#39;:
## 
##     cloud</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="9-3-structural-topic-model.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span>
<span id="cb256-2"><a href="9-3-structural-topic-model.html#cb256-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-3"><a href="9-3-structural-topic-model.html#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb256-4"><a href="9-3-structural-topic-model.html#cb256-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-5"><a href="9-3-structural-topic-model.html#cb256-5" aria-hidden="true" tabindex="-1"></a>data_inaugural_stm <span class="ot">&lt;-</span> <span class="fu">convert</span>(data_inaugural_dfm, <span class="at">to =</span> <span class="st">&quot;stm&quot;</span>)</span>
<span id="cb256-6"><a href="9-3-structural-topic-model.html#cb256-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-7"><a href="9-3-structural-topic-model.html#cb256-7" aria-hidden="true" tabindex="-1"></a>documents <span class="ot">&lt;-</span> data_inaugural_stm<span class="sc">$</span>documents</span>
<span id="cb256-8"><a href="9-3-structural-topic-model.html#cb256-8" aria-hidden="true" tabindex="-1"></a>vocabulary <span class="ot">&lt;-</span> data_inaugural_stm<span class="sc">$</span>vocab</span>
<span id="cb256-9"><a href="9-3-structural-topic-model.html#cb256-9" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> data_inaugural_stm<span class="sc">$</span>meta</span></code></pre></div>
<p>The first thing we have to do is find the number of topics we need. In the <code>stm</code> package, we can do this by using a function called <code>searchK</code>. Here, we specify a range of values that could include the “correct” number of topics, which we then run and collect. Afterwards, we then look at several goodness-of-fit measures to assess which number of topics (which <em>k</em>) has the best fit for the data. These measures include exclusivity, semantic coherence, held-out likelihood, bound, lbound, and residual dispersion. Here, we run this for 2 to 15 possible topics.</p>
<p>In our code, we specify our documents, our tokens (the vocabulary), and our meta-data. Moreover, as our prevalence, we include parameters for <em>Year</em> and <em>Party</em>, as we expect the content of the topics to differ between both the Republican and Democratic party, as well as over time:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="9-3-structural-topic-model.html#cb257-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>)</span></code></pre></div>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="9-3-structural-topic-model.html#cb258-1" aria-hidden="true" tabindex="-1"></a>findingk <span class="ot">&lt;-</span> <span class="fu">searchK</span>(documents, vocabulary, k, <span class="at">prevalence =</span> <span class="sc">~</span>Party <span class="sc">+</span></span>
<span id="cb258-2"><a href="9-3-structural-topic-model.html#cb258-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">s</span>(Year), <span class="at">data =</span> meta, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="9-3-structural-topic-model.html#cb259-1" aria-hidden="true" tabindex="-1"></a>findingk_results <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="fu">unlist</span>(findingk<span class="sc">$</span>results),</span>
<span id="cb259-2"><a href="9-3-structural-topic-model.html#cb259-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="fu">length</span>(<span class="fu">unlist</span>(findingk<span class="sc">$</span>results[<span class="dv">1</span>]))))</span>
<span id="cb259-3"><a href="9-3-structural-topic-model.html#cb259-3" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">names</span>(findingk<span class="sc">$</span>results)</span>
<span id="cb259-4"><a href="9-3-structural-topic-model.html#cb259-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(findingk_results) <span class="ot">&lt;-</span> names</span></code></pre></div>
<p>Looking at <code>findingk_results</code> we find various values. The first, exclusivity, refers to the occurrence that when words have a high probability under one topic, they have a low probability under others. Related to this is semantic coherence which happens when the most probable words in a topic should occur in the same document. Held-out (or held-out log-likelihood) is the likelihood of our model on data that was not used in the initial estimation (the lower the better), while residuals refer to the difference between a data point and the mean value that the model predicts for that data point (which we want to be 1, indicating a standard distribution). Finally, bound and lbound refer to a model’s internal measure of fit. Here, we will be looking for the number of topics, that balance the exclusivity and the semantic coherence, have a residual around 1, and a low held-out. To make this simpler, we visualise our data. In the first graph we plot all the values, while in the second, we only look at the exclusivity and the semantic coherence (as they are the most important):</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="9-3-structural-topic-model.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code></pre></div>
<pre><code>## 
## Caricamento pacchetto: &#39;reshape2&#39;</code></pre>
<pre><code>## Il seguente oggetto è mascherato da &#39;package:tidyr&#39;:
## 
##     smiths</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="9-3-structural-topic-model.html#cb263-1" aria-hidden="true" tabindex="-1"></a>findingk_melt <span class="ot">&lt;-</span> <span class="fu">melt</span>(findingk_results, <span class="at">id=</span><span class="st">&quot;K&quot;</span>) </span>
<span id="cb263-2"><a href="9-3-structural-topic-model.html#cb263-2" aria-hidden="true" tabindex="-1"></a>findingk_melt<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">as.character</span>(findingk_melt<span class="sc">$</span>variable)</span>
<span id="cb263-3"><a href="9-3-structural-topic-model.html#cb263-3" aria-hidden="true" tabindex="-1"></a>findingk<span class="sc">$</span>K <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(findingk_results<span class="sc">$</span>K)</span>
<span id="cb263-4"><a href="9-3-structural-topic-model.html#cb263-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-5"><a href="9-3-structural-topic-model.html#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(findingk_melt, <span class="fu">aes</span>(K, value)) <span class="sc">+</span></span>
<span id="cb263-6"><a href="9-3-structural-topic-model.html#cb263-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb263-7"><a href="9-3-structural-topic-model.html#cb263-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb263-8"><a href="9-3-structural-topic-model.html#cb263-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb263-9"><a href="9-3-structural-topic-model.html#cb263-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="Intro-to-Quantitative-Text-Analysis_files/figure-html/unnamed-chunk-169-1.png" width="672"  /></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="9-3-structural-topic-model.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(findingk_results, <span class="fu">aes</span>(semcoh, exclus)) <span class="sc">+</span></span>
<span id="cb264-2"><a href="9-3-structural-topic-model.html#cb264-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb264-3"><a href="9-3-structural-topic-model.html#cb264-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_text</span>(<span class="at">data=</span>findingk_results, <span class="at">label=</span>findingk<span class="sc">$</span>K, <span class="at">nudge_x =</span> <span class="fl">0.15</span>)<span class="sc">+</span></span>
<span id="cb264-4"><a href="9-3-structural-topic-model.html#cb264-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_x_continuous</span>(<span class="st">&quot;Semantic Coherence&quot;</span>)<span class="sc">+</span></span>
<span id="cb264-5"><a href="9-3-structural-topic-model.html#cb264-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_y_continuous</span>(<span class="st">&quot;Exclusivity&quot;</span>)<span class="sc">+</span></span>
<span id="cb264-6"><a href="9-3-structural-topic-model.html#cb264-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="Intro-to-Quantitative-Text-Analysis_files/figure-html/unnamed-chunk-169-2.png" width="672"  /></p>
<p>Based on these graphs, we decide upon 8 topics. The main reason for this is that for this number of topics, there is a high semantic coherence given the exclusivity. We can now run our stm model, using spectral initialization and a topical prevalence including both the Party and the Year of the inauguration. Also, we have a look at the topics, and the words with the highest probability attached to them:</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="9-3-structural-topic-model.html#cb265-1" aria-hidden="true" tabindex="-1"></a>n_topics <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb265-2"><a href="9-3-structural-topic-model.html#cb265-2" aria-hidden="true" tabindex="-1"></a>output_stm <span class="ot">&lt;-</span> <span class="fu">stm</span>(documents, vocabulary, <span class="at">K =</span> n_topics, <span class="at">prevalence =</span> <span class="sc">~</span>Party <span class="sc">+</span></span>
<span id="cb265-3"><a href="9-3-structural-topic-model.html#cb265-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">s</span>(Year), <span class="at">data =</span> meta, <span class="at">init.type =</span> <span class="st">&quot;Spectral&quot;</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="9-3-structural-topic-model.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">labelTopics</span>(output_stm)</span></code></pre></div>
<pre><code>## Topic 1 Top Words:
##       Highest Prob: free, peace, world, shall, freedom, must, faith 
##       FREX: strive, free, peoples, everywhere, truth, man&#39;s, learned 
##       Lift: abhorring, absorbing, abstractions, acquire, aggressor, amass, andes 
##       Score: anguished, productivity, strive, trial, learned, europe, defines 
## Topic 2 Top Words:
##       Highest Prob: us, new, world, let, can, people, america 
##       FREX: let, century, together, new, weapons, voices, abroad 
##       Lift: 200th, 20th, dawn, explore, micah, moon, music 
##       Score: attempting, nuclear, let, celebrate, voices, abroad, dawn 
## Topic 3 Top Words:
##       Highest Prob: us, must, world, government, people, america, can 
##       FREX: civilization, republic, experiment, normal, relationship, order, industrial 
##       Lift: abnormal, acclaim, accompanied, accord, accumulation, acknowledgment, addressing 
##       Score: accompanied, supreme, regards, deliberate, inspiration, unshaken, righteousness 
## Topic 4 Top Words:
##       Highest Prob: us, america, nation, can, must, new, people 
##       FREX: story, thank, president, defend, everyone, children, america 
##       Lift: blowing, breeze, democracy&#39;s, january, obama, other&#39;s, page 
##       Score: allowing, story, breeze, talk, crucial, everyone, virus 
## Topic 5 Top Words:
##       Highest Prob: freedom, nation, people, america, government, know, democracy 
##       FREX: speaks, mind, democracy, liberty, seen, came, millions 
##       Lift: abreast, absence, admiration, agent, amount, aspires, attempts 
##       Score: charta, speaks, paint, disaster, mind, defended, seen 
## Topic 6 Top Words:
##       Highest Prob: us, must, nation, people, can, new, every 
##       FREX: generation, journey, union, change, covenant, creed, enduring 
##       Lift: demanded, mastery, span, storms, absolutism, abundantly, afghanistan 
##       Score: abundantly, covenant, journey, mastery, storms, demanded, span 
## Topic 7 Top Words:
##       Highest Prob: can, world, people, peace, nations, must, government 
##       FREX: settlement, enforcement, countries, desire, party, international, property 
##       Lift: aided, eighteenth, abilities, abound, abounding, absurd, acceptance 
##       Score: abound, enforcement, contributed, settlement, property, major, eighteenth 
## Topic 8 Top Words:
##       Highest Prob: upon, government, shall, can, must, great, may 
##       FREX: army, interstate, negro, executive, tariff, business, proper 
##       Lift: affected, amendments, antitrust, army, attention, avail, banking 
##       Score: tariff, interstate, army, negro, policy, proper, business</code></pre>
<p>Here, we see that the word “us” is dominant in most topics, making it a candidate for removal as a stop word in a future analysis. Looking closer, we find that the first topic refers to peace, the second, third and seventh to the world, the fourth and sixth to America, and the eighth to the government.</p>
<p>Finally, we can see whether there is any relation between these topics and any of the parameters we included. Here, let us look at any existing differences between the two parties:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="9-3-structural-topic-model.html#cb268-1" aria-hidden="true" tabindex="-1"></a>est_assoc_effect <span class="ot">&lt;-</span> <span class="fu">estimateEffect</span>(<span class="sc">~</span>Party, output_stm, <span class="at">metadata =</span> meta,</span>
<span id="cb268-2"><a href="9-3-structural-topic-model.html#cb268-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fl">1e-05</span>)</span></code></pre></div>
<p>While we can visualise this with the <code>plot.estimateEffect</code> option, the visualisation is far from ideal. Thus, let us use some data-wrangling and make the plot ourselves:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="9-3-structural-topic-model.html#cb269-1" aria-hidden="true" tabindex="-1"></a>estimate_data <span class="ot">&lt;-</span> <span class="fu">plot.estimateEffect</span>(est_assoc_effect, <span class="st">&quot;Party&quot;</span>,</span>
<span id="cb269-2"><a href="9-3-structural-topic-model.html#cb269-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;pointestimate&quot;</span>, <span class="at">model =</span> output_stm, <span class="at">omit.plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb269-3"><a href="9-3-structural-topic-model.html#cb269-3" aria-hidden="true" tabindex="-1"></a>estimate_graph_means <span class="ot">&lt;-</span> estimate_data<span class="sc">$</span>means</span>
<span id="cb269-4"><a href="9-3-structural-topic-model.html#cb269-4" aria-hidden="true" tabindex="-1"></a>estimate_graph_means <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">unlist</span>(estimate_graph_means),</span>
<span id="cb269-5"><a href="9-3-structural-topic-model.html#cb269-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="fu">length</span>(estimate_graph_means), <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb269-6"><a href="9-3-structural-topic-model.html#cb269-6" aria-hidden="true" tabindex="-1"></a>estimate_graph_means <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Republicans&quot;</span>, <span class="dv">8</span>), <span class="fu">rep</span>(<span class="st">&quot;Democrats&quot;</span>,</span>
<span id="cb269-7"><a href="9-3-structural-topic-model.html#cb269-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8</span>)), <span class="fu">c</span>(estimate_graph_means<span class="sc">$</span>X1, estimate_graph_means<span class="sc">$</span>X2))</span>
<span id="cb269-8"><a href="9-3-structural-topic-model.html#cb269-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-9"><a href="9-3-structural-topic-model.html#cb269-9" aria-hidden="true" tabindex="-1"></a>estimate_graph_cis <span class="ot">&lt;-</span> estimate_data<span class="sc">$</span>cis</span>
<span id="cb269-10"><a href="9-3-structural-topic-model.html#cb269-10" aria-hidden="true" tabindex="-1"></a>estimate_graph_cis <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">unlist</span>(estimate_graph_cis),</span>
<span id="cb269-11"><a href="9-3-structural-topic-model.html#cb269-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="fu">length</span>(estimate_graph_cis), <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb269-12"><a href="9-3-structural-topic-model.html#cb269-12" aria-hidden="true" tabindex="-1"></a>estimate_graph_cis <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(estimate_graph_cis<span class="sc">$</span>X1, estimate_graph_cis<span class="sc">$</span>X3),</span>
<span id="cb269-13"><a href="9-3-structural-topic-model.html#cb269-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(estimate_graph_cis<span class="sc">$</span>X2, estimate_graph_cis<span class="sc">$</span>X4))</span>
<span id="cb269-14"><a href="9-3-structural-topic-model.html#cb269-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-15"><a href="9-3-structural-topic-model.html#cb269-15" aria-hidden="true" tabindex="-1"></a>Topic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Topic 1&quot;</span>, <span class="st">&quot;Topic 2&quot;</span>, <span class="st">&quot;Topic 3&quot;</span>, <span class="st">&quot;Topic 4&quot;</span>, <span class="st">&quot;Topic 5&quot;</span>,</span>
<span id="cb269-16"><a href="9-3-structural-topic-model.html#cb269-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Topic 6&quot;</span>, <span class="st">&quot;Topic 7&quot;</span>, <span class="st">&quot;Topic 8&quot;</span>, <span class="st">&quot;Topic 1&quot;</span>, <span class="st">&quot;Topic 2&quot;</span>, <span class="st">&quot;Topic 3&quot;</span>,</span>
<span id="cb269-17"><a href="9-3-structural-topic-model.html#cb269-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Topic 4&quot;</span>, <span class="st">&quot;Topic 5&quot;</span>, <span class="st">&quot;Topic 6&quot;</span>, <span class="st">&quot;Topic 7&quot;</span>, <span class="st">&quot;Topic 8&quot;</span>)</span>
<span id="cb269-18"><a href="9-3-structural-topic-model.html#cb269-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-19"><a href="9-3-structural-topic-model.html#cb269-19" aria-hidden="true" tabindex="-1"></a>estimate_graph <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Topic, estimate_graph_means, estimate_graph_cis)</span>
<span id="cb269-20"><a href="9-3-structural-topic-model.html#cb269-20" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(estimate_graph) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Topic&quot;</span>, <span class="st">&quot;Party&quot;</span>, <span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>)</span>
<span id="cb269-21"><a href="9-3-structural-topic-model.html#cb269-21" aria-hidden="true" tabindex="-1"></a>estimate_graph<span class="sc">$</span>Party <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(estimate_graph<span class="sc">$</span>Party)</span>
<span id="cb269-22"><a href="9-3-structural-topic-model.html#cb269-22" aria-hidden="true" tabindex="-1"></a>estimate_graph<span class="sc">$</span>Topic <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(estimate_graph<span class="sc">$</span>Topic)</span>
<span id="cb269-23"><a href="9-3-structural-topic-model.html#cb269-23" aria-hidden="true" tabindex="-1"></a>estimate_graph<span class="sc">$</span>Topic <span class="ot">&lt;-</span> <span class="fu">factor</span>(estimate_graph<span class="sc">$</span>Topic, <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(estimate_graph<span class="sc">$</span>Topic)))</span></code></pre></div>
<p>Now, let us plot our intervals:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="9-3-structural-topic-model.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(estimate_graph, <span class="fu">aes</span>(Mean, Topic)) <span class="sc">+</span> <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> min,</span>
<span id="cb270-2"><a href="9-3-structural-topic-model.html#cb270-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> max, <span class="at">color =</span> Party), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb270-3"><a href="9-3-structural-topic-model.html#cb270-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb270-4"><a href="9-3-structural-topic-model.html#cb270-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#0015BC&quot;</span>, <span class="st">&quot;#E9141D&quot;</span>)) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="Intro-to-Quantitative-Text-Analysis_files/figure-html/unnamed-chunk-174-1.png" width="672"  /></p>
<p>Here, we find that while the averages for the topic do seem to differ a little between both of the parties, all the intervals are overlapping, indicating that they are not that different.</p>

</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="9-2-seeded-latent-dirichlet-allocation.html"><button class="btn btn-default">Previous</button></a>
<a href="10-texttricks.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
